

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>2D Demonstration Workflow &#8212; GeostatsPy Well-documented Demonstration Geostatistical Workflows</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'GeostatsPy_workflow';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/AppliedGeostats.jpg" class="logo__image only-light" alt="GeostatsPy Well-documented Demonstration Geostatistical Workflows - Home"/>
    <script>document.write(`<img src="_static/AppliedGeostats.jpg" class="logo__image only-dark" alt="GeostatsPy Well-documented Demonstration Geostatistical Workflows - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_concepts.html">Geostatistical Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_probability.html">Probability Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_coordinate_transformations.html">Coordinate Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_univariate_statistics.html">Univariate Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_univariate_distributions.html">Univariate Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_parametric_distributions.html">Parametric Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_parametric_distributions_fitting.html">Parametric Distributions Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_expectation.html">Statistical Expectation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_monte_carlo_simulation.html">Monte Carlo Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_transformations.html">Distribution Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_heterogeneity_metrics.html">Spatial Heterogeneity Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_confidence_interval.html">Confidence Intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_hypothesis_testing.html">Hypothesis Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_bivariate.html">Bivariate Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_QQ.html">QQ-Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_linear_regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_plotting_spatial_data_models.html">Plotting Spatial Data and Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_bootstrap.html">Bootstrap Uncertainty Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_declustering.html">Declustering to Debias Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_declustering_all_methods.html">Advanced Declustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_calculation.html">Variogram Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_models.html">Variogram Positive Definite Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_models_simulation.html">Variogram Models, Simulation Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_calculation_and_modeling.html">Variogram Calculation and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_from_image.html">Variogram Calculation from an Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_trends.html">Trend Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_2D1D_trend.html">Spatial Trend Modeling, 1D + 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_inv_distance.html">Inverse Distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging.html">Simple and Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_categorical_indictor_kriging.html">Indicator Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_simulation.html">Stochastic Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging_vs_simulation_1D.html">Kriging vs. Simulation, 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging_vs_simulation_maps.html">Kriging vs. Simulation, 2D Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_categorical_indicator_simulation.html">Indicator Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_3D_simulation.html">3D Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_cosimulation.html">Cosimulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_ergodic_fluctuations.html">Ergodic Fluctuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_simulation_postsim.html">Simulation Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_model_checking.html">Model Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_volume_variance.html">Volume-Variance Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_decision_making.html">Decision Making with Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_datasets.html">Synthetic Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy.html">GeostatsPy Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusions.html">Conclusions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book/issues/new?title=Issue%20on%20page%20%2FGeostatsPy_workflow.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/GeostatsPy_workflow.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2D Demonstration Workflow</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-for-a-complete-demonstration-workflow">Motivation for a Complete Demonstration Workflow.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-modeling-workflow-steps">Spatial Modeling Workflow Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-required-libraries">Load the Required Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-custom-colorbar">Make Custom Colorbar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-working-directory">Set the Working Directory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-tabular-and-gridded-datasets">Load Tabular and Gridded Datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-and-grid-dictionary">Dataset and Grid Dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-dataset">Visualize the Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate-analysis">Univariate Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debiasing-the-distributions">Debiasing the Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicator-facies-variograms">Indicator Facies Variograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicator-simulation-of-facies">Indicator Simulation of Facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-the-dataset-by-facies-and-gaussian-transformation-by-facies">Split the Dataset by Facies and Gaussian Transformation By-facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-continuous-feature-by-facies-experimental-variograms">Calculate Continuous Feature, By-facies Experimental Variograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porosity-simulation-by-facies">Porosity Simulation By-facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-limits-for-plotting-colorbars-and-grid-specification">Set Limits for Plotting, Colorbars and Grid Specification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analytics-and-visualization">Data Analytics and Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-kriging">Simple Kriging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-gaussian-simulation">Sequential Gaussian Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-simulated-realizations-and-a-kriged-estimation-model">Visualize Simulated Realizations and a Kriged Estimation Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="d-demonstration-workflow">
<h1>2D Demonstration Workflow<a class="headerlink" href="#d-demonstration-workflow" title="Permalink to this heading">#</a></h1>
<p>Michael J. Pyrcz, Professor, The University of Texas at Austin</p>
<p><a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
<p>Chapter of e-book “Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy”.</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite this e-Book as:</p>
<p>Pyrcz, M.J., 2024, <em>Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</em> [e-book]. Zenodo. doi:10.5281/zenodo.15169133 <a class="reference external" href="https://doi.org/10.5281/zenodo.15169132"><img alt="DOI" src="https://zenodo.org/badge/838927017.svg" /></a></p>
</div>
<p>The workflows in this book and more are available here:</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite the GeostatsPyDemos GitHub Repository as:</p>
<p>Pyrcz, M.J., 2024, <em>GeostatsPyDemos: GeostatsPy Python Package for Spatial Data Analytics and Geostatistics Demonstration Workflows Repository</em> (0.0.1) [Software]. Zenodo. doi:10.5281/zenodo.12667036. GitHub Repository: <a class="github reference external" href="https://github.com/GeostatsGuy/GeostatsPyDemos">GeostatsGuy/GeostatsPyDemos</a> <a class="reference external" href="https://doi.org/10.5281/zenodo.12667035"><img alt="DOI" src="https://zenodo.org/badge/777871341.svg" /></a></p>
</div>
<p>By Michael J. Pyrcz <br />
© Copyright 2024.</p>
<p>This chapter is a tutorial for / demonstration of a <strong>Complete Demonstration Workflow</strong> with a 2D example.</p>
<p><strong>YouTube Lecture</strong>: check out my complete lecture playlist on:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://youtube.com/playlist?list=PLG19vXLQHvSB-D4XKYieEku9GQMQyAzjJ&amp;si=C5RK9p1vJ9anfxtj">Data Analytics and Geostatistics</a></p></li>
</ul>
<section id="motivation-for-a-complete-demonstration-workflow">
<h2>Motivation for a Complete Demonstration Workflow.<a class="headerlink" href="#motivation-for-a-complete-demonstration-workflow" title="Permalink to this heading">#</a></h2>
<p>All of the workflow steps are available in the other e-book chapter, for example,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_plotting_spatial_data_models.html">Plotting Spatial Data and Models</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_univariate_statistics.html">Univariate Analysis</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_bivariate.html">Bivariate Analysis</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_declustering.html">Debiasing Spatial Data</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_variogram_calculation_and_modeling.html">Spatial Analysis</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_kriging.html">Spatial Estimation</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_simulation.html">Spatial Simulation</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_model_checking.html">Model Checking</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_simulation_postsim.html">Uncertainty Analysis</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_decision_making.html">Decision Making</a></p></li>
</ul>
<p>Yet, I encounter students that struggling with putting all of this together! This chapter puts all of this together to demonstrate how all these parts work together with general workflow that will be useful for many spatial modeling cases.</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">This is not a panacea workflow!</p>
<p>This is a good, general spatial modeling workflow, but your must consider the modeling goal and available resources when designing your own spatial modeling workflows.</p>
</div>
</section>
<section id="spatial-modeling-workflow-steps">
<h2>Spatial Modeling Workflow Steps<a class="headerlink" href="#spatial-modeling-workflow-steps" title="Permalink to this heading">#</a></h2>
</section>
<section id="load-the-required-libraries">
<h2>Load the Required Libraries<a class="headerlink" href="#load-the-required-libraries" title="Permalink to this heading">#</a></h2>
<p>The following code loads the required libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geostatspy.GSLIB</span> <span class="k">as</span> <span class="nn">GSLIB</span>                              <span class="c1"># GSLIB utilities, visualization and wrapper</span>
<span class="kn">import</span> <span class="nn">geostatspy.geostats</span> <span class="k">as</span> <span class="nn">geostats</span>                        <span class="c1"># GSLIB methods convert to Python      </span>
<span class="kn">import</span> <span class="nn">geostatspy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GeostatsPy version: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">geostatspy</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GeostatsPy version: 0.0.78
</pre></div>
</div>
</div>
</div>
<p>We will also need some standard packages. These should have been installed with Anaconda 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>                                                     <span class="c1"># set working directory, run executables</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>                                         <span class="c1"># suppress the status bar</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partialmethod</span>
<span class="n">tqdm</span><span class="o">.</span><span class="fm">__init__</span> <span class="o">=</span> <span class="n">partialmethod</span><span class="p">(</span><span class="n">tqdm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ignore_warnings</span> <span class="o">=</span> <span class="kc">True</span>                                        <span class="c1"># ignore warnings?</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                                            <span class="c1"># ndarrays for gridded data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>                                           <span class="c1"># DataFrames for tabular data</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>                               <span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>                                      <span class="c1"># custom colorbar</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>                            <span class="c1"># custom axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">)</span> <span class="c1"># control of axes ticks</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>                               <span class="c1"># custom subplots</span>
<span class="n">formatter</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>    <span class="c1"># commas on axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                <span class="c1"># plot all grids below the plot elements</span>
<span class="k">if</span> <span class="n">ignore_warnings</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>                                   
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.utils</span> <span class="kn">import</span> <span class="n">io</span>                                  <span class="c1"># mute output from simulation</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>                                         <span class="c1"># color map</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">13</span>                                                     <span class="c1"># random number seed</span>
<span class="n">burnt_orange</span> <span class="o">=</span> <span class="s1">&#39;#BF5700&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>If you get a package import error, you may have to first install some of these packages. This can usually be accomplished by opening up a command window on Windows and then typing ‘python -m pip install [package-name]’. More assistance is available with the respective package docs.</p>
</section>
<section id="make-custom-colorbar">
<h2>Make Custom Colorbar<a class="headerlink" href="#make-custom-colorbar" title="Permalink to this heading">#</a></h2>
<p>We make this colorbar to display our categorical, sand and shale facies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap_facies</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;gold&#39;</span><span class="p">])</span>
<span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">);</span> <span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="declare-functions">
<h2>Declare Functions<a class="headerlink" href="#declare-functions" title="Permalink to this heading">#</a></h2>
<p>Here are some convenience functions including,</p>
<ol class="arabic simple">
<li><p>add major and minor gridlines</p></li>
<li><p>location maps formatted for binary, sand and shale facies.</p></li>
<li><p>histogram formatted for bianry, sand and shale facies.</p></li>
<li><p>improved formmatting for axes labels</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_grid2</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks  </span>

<span class="k">def</span> <span class="nf">add_grid</span><span class="p">(</span><span class="n">sub_plot</span><span class="p">):</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">sub_plot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">sub_plot</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks</span>

<span class="k">def</span> <span class="nf">locmap_facies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">xcol</span><span class="p">,</span><span class="n">ycol</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">xlabel</span><span class="p">,</span><span class="n">ylabel</span><span class="p">,</span><span class="n">vlabel</span><span class="p">,</span><span class="n">cmap</span><span class="p">):</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="n">ycol</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">))</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">vlabel</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;Shale&#39;</span><span class="p">,</span> <span class="s1">&#39;Sand&#39;</span><span class="p">])</span>
    
<span class="k">def</span> <span class="nf">hist_sand_shale</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">vcol</span><span class="p">,</span><span class="n">title</span><span class="p">):</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">vcol</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">patches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;grey&#39;</span><span class="p">);</span> <span class="n">patches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span> <span class="c1"># Set custom colors for each bar</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Shalestone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sandstone&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">AutoMinorLocator</span><span class="p">());</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;small&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;large&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">,.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;int&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;one&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-the-working-directory">
<h2>Set the Working Directory<a class="headerlink" href="#set-the-working-directory" title="Permalink to this heading">#</a></h2>
<p>I always like to do this so I don’t lose files and to simplify subsequent read and writes (avoid including the full address each time).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#os.chdir(&quot;c:/PGE383&quot;)                                        # set the working directory</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-tabular-and-gridded-datasets">
<h2>Load Tabular and Gridded Datasets<a class="headerlink" href="#load-tabular-and-gridded-datasets" title="Permalink to this heading">#</a></h2>
<p>Here’s the command to load our comma delimited data file in to a Pandas’ DataFrame object.</p>
<p>The dataset includes,</p>
<ol class="arabic simple">
<li><p>sparsely sampled spatial well data,</p></li>
</ol>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>X</p></td>
<td class="text-center"><p>X</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>x coordinate</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Y</p></td>
<td class="text-center"><p>Y</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>y coordinate</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>Facies</p></td>
<td class="text-center"><p>indicator</p></td>
<td><p>0 = shalestone, 1 = sandstone</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>Porosity</p></td>
<td class="text-center"><p>ratio</p></td>
<td><p>effective porosity</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Permeability</p></td>
<td class="text-center"><p>Perm</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(mD\)</span></p></td>
<td><p>isotropic, horizontal</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>exahustively sampled seismic data,</p></li>
</ol>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Full Name</p></th>
<th class="head text-center"><p>Name</p></th>
<th class="head text-center"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Acoustic Impedance</p></td>
<td class="text-center"><p>AI</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{kg}{m^2 \cdot s}\)</span></p></td>
<td><p>interpolated from seismic</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_sample_data.csv&quot;</span><span class="p">)</span>
<span class="n">AI_12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://raw.githubusercontent.com/GeostatsGuy/GeoDataSets/master/12_AI.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">df_12</span> <span class="o">=</span> <span class="n">df_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:];</span> <span class="n">df_12</span> <span class="o">=</span> <span class="n">df_12</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Porosity&#39;</span><span class="p">:</span><span class="s1">&#39;Por&#39;</span><span class="p">})</span>    <span class="c1"># clean up the data table</span>
<span class="n">df_12</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
      <th>Facies</th>
      <th>Por</th>
      <th>Perm</th>
      <th>AI</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>502.929859</td>
      <td>9008.972357</td>
      <td>1</td>
      <td>0.220761</td>
      <td>140.021266</td>
      <td>3413.063944</td>
    </tr>
    <tr>
      <th>1</th>
      <td>508.696361</td>
      <td>8505.744515</td>
      <td>1</td>
      <td>0.237154</td>
      <td>39.837129</td>
      <td>3074.562617</td>
    </tr>
    <tr>
      <th>2</th>
      <td>503.892888</td>
      <td>8003.429847</td>
      <td>1</td>
      <td>0.234352</td>
      <td>84.992437</td>
      <td>2292.783358</td>
    </tr>
    <tr>
      <th>3</th>
      <td>508.230145</td>
      <td>7509.751406</td>
      <td>1</td>
      <td>0.244553</td>
      <td>90.632307</td>
      <td>2494.848885</td>
    </tr>
    <tr>
      <th>4</th>
      <td>500.611637</td>
      <td>7000.684230</td>
      <td>1</td>
      <td>0.231787</td>
      <td>811.547979</td>
      <td>2522.063995</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="dataset-and-grid-dictionary">
<h3>Dataset and Grid Dictionary<a class="headerlink" href="#dataset-and-grid-dictionary" title="Permalink to this heading">#</a></h3>
<p>Here’s a dictionary with all the information for each feature from this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">twelve</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Facies&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;colormap&quot;</span><span class="p">:</span> <span class="s2">&quot;cmap_facies&quot;</span><span class="p">,</span>         
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Facies&quot;</span><span class="p">,</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="s2">&quot;Facies&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;Sand - 1, Shale - 0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Por&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
        <span class="s2">&quot;colormap&quot;</span><span class="p">:</span> <span class="s2">&quot;inferno&quot;</span><span class="p">,</span>       
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Porosity&quot;</span><span class="p">,</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="s2">&quot;Por&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;fraction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;small&#39;</span>
    <span class="p">},</span>
    <span class="s2">&quot;Perm&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
        <span class="s2">&quot;colormap&quot;</span><span class="p">:</span> <span class="s2">&quot;inferno&quot;</span><span class="p">,</span>       
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Permeability&quot;</span><span class="p">,</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="s2">&quot;Perm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;mD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;large&#39;</span>
    <span class="p">},</span>
    <span class="s2">&quot;AI&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span>
        <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">6500</span><span class="p">,</span>
        <span class="s2">&quot;colormap&quot;</span><span class="p">:</span> <span class="s2">&quot;inferno&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Acoustic Impedance&quot;</span><span class="p">,</span><span class="s2">&quot;fname&quot;</span><span class="p">:</span> <span class="s2">&quot;AI&quot;</span><span class="p">,</span>
        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{kg}</span><span class="s2">{m^2 \cdot s} \times 10^3$&quot;</span><span class="p">,</span>
        <span class="s2">&quot;map&quot;</span><span class="p">:</span> <span class="n">AI_12</span><span class="p">,</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;large&#39;</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="n">grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;nx&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;ny&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;xsiz&quot;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span>
    <span class="s2">&quot;ysiz&quot;</span><span class="p">:</span><span class="mf">100.0</span><span class="p">,</span>
    <span class="s2">&quot;xmn&quot;</span><span class="p">:</span><span class="mf">50.0</span><span class="p">,</span>
    <span class="s2">&quot;ymn&quot;</span><span class="p">:</span><span class="mf">50.0</span><span class="p">,</span>
    <span class="s2">&quot;xmin&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;xmax&quot;</span><span class="p">:</span><span class="mf">10000.0</span><span class="p">,</span>
    <span class="s2">&quot;ymin&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="s2">&quot;ymax&quot;</span><span class="p">:</span><span class="mf">10000.0</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-the-dataset">
<h3>Visualize the Dataset<a class="headerlink" href="#visualize-the-dataset" title="Permalink to this heading">#</a></h3>
<p>Now we can load and visualize the synthetic dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">20</span>                                                     <span class="c1"># number of histogram bins</span>

<span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twelve</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;Facies&#39;</span><span class="p">:</span>
        <span class="n">locmap_facies</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Well Data Location Map&#39;</span><span class="p">,</span><span class="s1">&#39;X (m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y (m)&#39;</span><span class="p">,</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Well Data Location Map&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;colormap&quot;</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;map&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">AI_12</span><span class="p">,</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]],</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">vmax</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span>
                    <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;colormap&quot;</span><span class="p">])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Well Data Location Map and Grid&#39;</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1567702458b3a7f226261d06c9dcda4bd8707358c430d5388a2a3f3543b3de6f.png" src="_images/1567702458b3a7f226261d06c9dcda4bd8707358c430d5388a2a3f3543b3de6f.png" />
</div>
</div>
</section>
</section>
<section id="univariate-analysis">
<h2>Univariate Analysis<a class="headerlink" href="#univariate-analysis" title="Permalink to this heading">#</a></h2>
<p>Now let’s look at the univariate distributions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbin</span> <span class="o">=</span> <span class="mi">20</span>                                                     <span class="c1"># number of histogram bins</span>

<span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">twelve</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">feature</span> <span class="o">==</span> <span class="s1">&#39;Facies&#39;</span><span class="p">:</span>         
        <span class="n">hist_sand_shale</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">],</span><span class="s1">&#39;Twelve: Facies Well Data Distribution&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                 <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Well Data&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Average: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.82</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;St.Dev.: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.77</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;P10:     &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.72</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;P90:     &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="mi">2</span><span class="p">)),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.67</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;n:       &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))),[</span><span class="mf">0.78</span><span class="p">,</span><span class="mf">0.62</span><span class="p">],</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;axes fraction&#39;</span><span class="p">)</span>
        <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;format&quot;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">&#39; Well Data Distribution&#39;</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;map&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;map&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
                     <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seismic&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/145b69fd4273f13694c5b749f066c3ade1f8b77638f58df653fc8eeddd4f0bfa.png" src="_images/145b69fd4273f13694c5b749f066c3ade1f8b77638f58df653fc8eeddd4f0bfa.png" />
</div>
</div>
</section>
<section id="debiasing-the-distributions">
<h2>Debiasing the Distributions<a class="headerlink" href="#debiasing-the-distributions" title="Permalink to this heading">#</a></h2>
<p>From ocular inspection of the dataset, it is apparent that the data is sampled in a biased manner.</p>
<ul class="simple">
<li><p>We attempt to mitigate this with cell-based declustering.</p></li>
</ul>
<p>First let’s check the facies feature.</p>
<ul class="simple">
<li><p>since it is shale (0) and sand (1), we are calculating the representative proportion of sand and the compliment proportion of shale</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
prop_{shale} = 1.0 - prop_{sand}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">declustered_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="s1">&#39;Por&#39;</span><span class="p">,</span><span class="s1">&#39;Perm&#39;</span><span class="p">]</span>

<span class="n">ncell</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">cmin</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span> <span class="n">noff</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">iminmax</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Facies&#39;</span>

<span class="n">wts</span><span class="p">,</span> <span class="n">cell_sizes</span><span class="p">,</span> <span class="n">dmeans</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">declus</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">iminmax</span> <span class="o">=</span> <span class="n">iminmax</span><span class="p">,</span><span class="n">noff</span> <span class="o">=</span> <span class="n">noff</span><span class="p">,</span>
        <span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span><span class="p">,</span><span class="n">cmin</span> <span class="o">=</span> <span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span> <span class="o">=</span> <span class="n">cmax</span><span class="p">)</span>                <span class="c1"># GeostatsPy&#39;s declustering function</span>
<span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wts</span>                                               <span class="c1"># add weights to the sample data DataFrame</span>

<span class="n">sand_prop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">sand_dprop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">csize_min</span> <span class="o">=</span> <span class="n">cell_sizes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dmeans</span><span class="p">)]</span>                     <span class="c1"># retrieve the minimizing cell size</span>
<span class="n">smin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">smax</span> <span class="o">=</span> <span class="mf">1.0</span>                                          <span class="c1"># range of statistic on y axis, set to improve visualization</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cell_sizes</span><span class="p">,</span><span class="n">dmeans</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">facecolors</span> <span class="o">=</span> <span class="n">burnt_orange</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cell Size (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Sand Proportion vs. Cell Size&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">sand_prop</span><span class="p">,</span><span class="n">sand_prop</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">sand_dprop</span><span class="p">,</span><span class="n">sand_dprop</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">csize_min</span><span class="p">,</span><span class="n">csize_min</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">sand_dprop</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">sand_prop</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Naive &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Sand Proportion = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sand_prop</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">sand_dprop</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Sand Proportion = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sand_dprop</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.70</span> <span class="o">*</span> <span class="p">(</span><span class="n">sand_dprop</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Minimizing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.63</span> <span class="o">*</span> <span class="p">(</span><span class="n">sand_dprop</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Cell Size = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">csize_min</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">smin</span><span class="p">,</span><span class="n">smax</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">)</span>
<span class="n">add_grid2</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 480 data with:
   mean of      0.6166666666666667 
   min and max  0 and 1
   standard dev 0.486198404860494 
</pre></div>
</div>
<img alt="_images/bd9b133e3241adf3fe723feac846f5b54f74fd622e2beecaa31785ba3ec21eba.png" src="_images/bd9b133e3241adf3fe723feac846f5b54f74fd622e2beecaa31785ba3ec21eba.png" />
</div>
</div>
<p>Now let’s decluster the porosity feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncell</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">cmin</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span> <span class="n">noff</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">iminmax</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Por&#39;</span>

<span class="n">wts</span><span class="p">,</span> <span class="n">cell_sizes</span><span class="p">,</span> <span class="n">dmeans</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">declus</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">iminmax</span> <span class="o">=</span> <span class="n">iminmax</span><span class="p">,</span><span class="n">noff</span> <span class="o">=</span> <span class="n">noff</span><span class="p">,</span>
        <span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span><span class="p">,</span><span class="n">cmin</span> <span class="o">=</span> <span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span> <span class="o">=</span> <span class="n">cmax</span><span class="p">)</span>                <span class="c1"># GeostatsPy&#39;s declustering function</span>
<span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wts</span>                                               <span class="c1"># add weights to the sample data DataFrame</span>

<span class="n">por_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">por_dmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">csize_min</span> <span class="o">=</span> <span class="n">cell_sizes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dmeans</span><span class="p">)]</span>                     <span class="c1"># retrieve the minimizing cell size</span>
<span class="n">smin</span> <span class="o">=</span> <span class="mf">0.17</span><span class="p">;</span> <span class="n">smax</span> <span class="o">=</span> <span class="mf">0.20</span>                                          <span class="c1"># range of statistic on y axis, set to improve visualization</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cell_sizes</span><span class="p">,</span><span class="n">dmeans</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">facecolors</span> <span class="o">=</span> <span class="n">burnt_orange</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cell Size (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean vs. Cell Size&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">por_mean</span><span class="p">,</span><span class="n">por_mean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">por_dmean</span><span class="p">,</span><span class="n">por_dmean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">csize_min</span><span class="p">,</span><span class="n">csize_min</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">por_dmean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">por_mean</span><span class="o">+</span><span class="mf">0.0006</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Naive &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">por_mean</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">por_dmean</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">por_dmean</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.70</span> <span class="o">*</span> <span class="p">(</span><span class="n">por_dmean</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Minimizing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.63</span> <span class="o">*</span> <span class="p">(</span><span class="n">por_dmean</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Cell Size = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">csize_min</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">smin</span><span class="p">,</span><span class="n">smax</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">)</span>
<span class="n">add_grid2</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 480 data with:
   mean of      0.1894398892479167 
   min and max  0.117561964 and 0.261090681
   standard dev 0.031668598431014224 
</pre></div>
</div>
<img alt="_images/94e78d74b1f055c72b73b12f76c75b1d30c74f27445ccbac66c8b4f76370e9f3.png" src="_images/94e78d74b1f055c72b73b12f76c75b1d30c74f27445ccbac66c8b4f76370e9f3.png" />
</div>
</div>
<p>and finally the permeability feature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncell</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">cmin</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span> <span class="n">noff</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="n">iminmax</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;Perm&#39;</span>

<span class="n">wts</span><span class="p">,</span> <span class="n">cell_sizes</span><span class="p">,</span> <span class="n">dmeans</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">declus</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">iminmax</span> <span class="o">=</span> <span class="n">iminmax</span><span class="p">,</span><span class="n">noff</span> <span class="o">=</span> <span class="n">noff</span><span class="p">,</span>
        <span class="n">ncell</span> <span class="o">=</span> <span class="n">ncell</span><span class="p">,</span><span class="n">cmin</span> <span class="o">=</span> <span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span> <span class="o">=</span> <span class="n">cmax</span><span class="p">)</span>                <span class="c1"># GeostatsPy&#39;s declustering function</span>
<span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wts</span>                                               <span class="c1"># add weights to the sample data DataFrame</span>

<span class="n">perm_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">perm_dmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span> <span class="o">+</span> <span class="s1">&#39;_Wts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">csize_min</span> <span class="o">=</span> <span class="n">cell_sizes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dmeans</span><span class="p">)]</span>                     <span class="c1"># retrieve the minimizing cell size</span>
<span class="n">smin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">smax</span> <span class="o">=</span> <span class="mf">750.0</span>                                      <span class="c1"># range of statistic on y axis, set to improve visualization</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cell_sizes</span><span class="p">,</span><span class="n">dmeans</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">edgecolors</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">facecolors</span> <span class="o">=</span> <span class="n">burnt_orange</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cell Size (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean vs. Cell Size&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">perm_mean</span><span class="p">,</span><span class="n">perm_mean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">],[</span><span class="n">perm_dmean</span><span class="p">,</span><span class="n">perm_dmean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">csize_min</span><span class="p">,</span><span class="n">csize_min</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">perm_dmean</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">perm_mean</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Naive &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="o">*</span><span class="p">(</span><span class="n">cmax</span> <span class="o">-</span> <span class="n">cmin</span><span class="p">)</span> <span class="o">+</span> <span class="n">cmin</span><span class="p">,</span> <span class="n">perm_dmean</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Declustered &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.70</span> <span class="o">*</span> <span class="p">(</span><span class="n">perm_dmean</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Minimizing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">csize_min</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.63</span> <span class="o">*</span> <span class="p">(</span><span class="n">perm_dmean</span> <span class="o">-</span> <span class="n">smin</span><span class="p">)</span> <span class="o">+</span> <span class="n">smin</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Cell Size = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">csize_min</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">smin</span><span class="p">,</span><span class="n">smax</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">)</span>
<span class="n">add_grid2</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 480 data with:
   mean of      520.9320931825771 
   min and max  0.005775512 and 10319.90485
   standard dev 1224.929225333125 
</pre></div>
</div>
<img alt="_images/dfd860882a09b0d957e4dc49d558d10e8b61ac59543140a0181a97f8154b20fc.png" src="_images/dfd860882a09b0d957e4dc49d558d10e8b61ac59543140a0181a97f8154b20fc.png" />
</div>
</div>
<p>Now, let’s visualize,</p>
<ul class="simple">
<li><p>location map of the desclustering weights</p></li>
<li><p>declustered histograms</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">declustered_features</span><span class="p">):</span>                   <span class="c1"># loop over features</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">declustered_features</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Wts&#39;</span><span class="p">,</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Declustering Weights Location Map&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span>
                <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="mi">10</span><span class="p">),</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">declustered_features</span><span class="p">),</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>   
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">weights</span><span class="o">=</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="o">+</span><span class="s1">&#39;_Wts&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Declustered&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="n">nbin</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naive&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">fformatter</span> <span class="o">=</span> <span class="n">get_formatter</span><span class="p">(</span><span class="n">df_12</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;format&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">fformatter</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span>  <span class="s1">&#39; Well Data Distribution&#39;</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>
     
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">3.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fcd30480ea0afb3f011d7b42e65d1f9418b227ad1368802719c9d912b1cbf48f.png" src="_images/fcd30480ea0afb3f011d7b42e65d1f9418b227ad1368802719c9d912b1cbf48f.png" />
</div>
</div>
</section>
<section id="indicator-facies-variograms">
<h2>Indicator Facies Variograms<a class="headerlink" href="#indicator-facies-variograms" title="Permalink to this heading">#</a></h2>
<p>Since we have only two facies, we can just calculate and model a single indicator variogram model.</p>
<ul class="simple">
<li><p>since the facies are already 0 (shale) and 1 (sand) we do not need to apply the indicator transformation</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mf">9999.</span><span class="p">;</span> 
<span class="n">lag_dist</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">;</span> <span class="n">lag_tol</span> <span class="o">=</span> <span class="mf">250.0</span><span class="p">;</span> <span class="n">nlag</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">bandh</span> <span class="o">=</span> <span class="mf">9999.9</span><span class="p">;</span> <span class="n">azi</span> <span class="o">=</span> <span class="mi">165</span><span class="p">;</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">22.5</span><span class="p">;</span> <span class="n">isill</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">lag_maj</span><span class="p">,</span> <span class="n">facies_maj_gamma</span><span class="p">,</span> <span class="n">facies_maj_npair</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;Facies&quot;</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">lag_dist</span><span class="p">,</span><span class="n">lag_tol</span><span class="p">,</span><span class="n">nlag</span><span class="p">,</span><span class="n">azi</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span>
            <span class="n">bandh</span><span class="p">,</span><span class="n">isill</span><span class="p">)</span>
<span class="n">lag_min</span><span class="p">,</span> <span class="n">facies_min_gamma</span><span class="p">,</span> <span class="n">facies_min_npair</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;Facies&quot;</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">lag_dist</span><span class="p">,</span><span class="n">lag_tol</span><span class="p">,</span><span class="n">nlag</span><span class="p">,</span><span class="n">azi</span><span class="p">,</span><span class="n">atol</span><span class="o">+</span><span class="mf">90.0</span><span class="p">,</span>
            <span class="n">bandh</span><span class="p">,</span><span class="n">isill</span><span class="p">)</span>

<span class="n">nug</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">nst</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">it1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">cc1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">azi_facies</span> <span class="o">=</span> <span class="mi">165</span><span class="p">;</span> <span class="n">hmaj_facies</span> <span class="o">=</span><span class="mi">8000</span><span class="p">;</span> <span class="n">hmin_facies</span> <span class="o">=</span> <span class="mi">4500</span>                <span class="c1"># first structure</span>

<span class="n">vario_facies</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="p">,</span><span class="n">nst</span><span class="p">,</span><span class="n">it1</span><span class="p">,</span><span class="n">cc1</span><span class="p">,</span><span class="n">azi_facies</span><span class="p">,</span><span class="n">hmaj_facies</span><span class="p">,</span><span class="n">hmin_facies</span><span class="p">)</span>

<span class="n">nlag</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">xlag</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">azm</span> <span class="o">=</span> <span class="mi">45</span>                               <span class="c1"># project the model in the 045 and 135 azimuth</span>
<span class="n">index_maj</span><span class="p">,</span><span class="n">h_maj</span><span class="p">,</span><span class="n">gam_maj</span><span class="p">,</span><span class="n">cov_maj</span><span class="p">,</span><span class="n">ro_maj</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">vmodel</span><span class="p">(</span><span class="n">nlag</span><span class="p">,</span><span class="n">xlag</span><span class="p">,</span><span class="n">azi_facies</span><span class="p">,</span><span class="n">vario_facies</span><span class="p">)</span>
<span class="n">index_min</span><span class="p">,</span><span class="n">h_min</span><span class="p">,</span><span class="n">gam_min</span><span class="p">,</span><span class="n">cov_min</span><span class="p">,</span><span class="n">ro_min</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">vmodel</span><span class="p">(</span><span class="n">nlag</span><span class="p">,</span><span class="n">xlag</span><span class="p">,</span><span class="n">azi_facies</span><span class="o">+</span><span class="mi">90</span><span class="p">,</span><span class="n">vario_facies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>                                              <span class="c1"># plot the major variograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lag_maj</span><span class="p">,</span><span class="n">facies_maj_gamma</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orangered&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="n">facies_maj_npair</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Major Experimental, Azi = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi_facies</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_maj</span><span class="p">,</span><span class="n">gam_maj</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Major Model, Azi &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi_facies</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lag_min</span><span class="p">,</span><span class="n">facies_min_gamma</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;forestgreen&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="n">facies_maj_npair</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Minor Experimental, Azi = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi_facies</span> <span class="o">+</span> <span class="mi">90</span><span class="p">),</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_min</span><span class="p">,</span><span class="n">gam_min</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;forestgreen&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minor Model, Azi &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi_facies</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Sill&#39;</span><span class="p">,(</span><span class="mi">15</span><span class="p">,</span><span class="mf">1.02</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Lag Distance $\bf(h)$, (m)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\gamma \bf(h)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Facies Indicator Variogram - Major Direction &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.8</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span> <span class="n">add_grid2</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> x,y,z offsets = 25.881904828103835,-96.5925825437387
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> x,y,z offsets = -96.59258249728337,-25.881905001477506
</pre></div>
</div>
<img alt="_images/569f16f301b299077530e46decf13692736f2a2070a2f460e06a0e45abfb4b62.png" src="_images/569f16f301b299077530e46decf13692736f2a2070a2f460e06a0e45abfb4b62.png" />
</div>
</div>
</section>
<section id="indicator-simulation-of-facies">
<h2>Indicator Simulation of Facies<a class="headerlink" href="#indicator-simulation-of-facies" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display        
<span class="n">features_mat</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Por&#39;</span><span class="p">,</span><span class="s1">&#39;Perm&#39;</span><span class="p">];</span> <span class="n">facies_mat</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Shale&#39;</span><span class="p">,</span><span class="s1">&#39;Sand&#39;</span><span class="p">]</span> <span class="c1"># location maps</span>

<span class="n">ncut</span> <span class="o">=</span> <span class="mi">2</span>                                                      <span class="c1"># number of facies</span>
<span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>                                                <span class="c1"># facies categories (use consistent order for all lists)</span>
<span class="n">gcdf_facies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">sand_dprop</span><span class="p">,</span><span class="n">sand_dprop</span><span class="p">]</span>                  <span class="c1"># global proportions of the categories (shale, sand)</span>
<span class="n">dummy_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>                               <span class="c1"># current version requires trend - if wrong size = ignored </span>

<span class="n">ndmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ndmax</span> <span class="o">=</span> <span class="mi">10</span>                                         <span class="c1"># minimum and maximum data for indicator kriging</span>
<span class="n">nodmax</span> <span class="o">=</span> <span class="mi">10</span>                                                   <span class="c1"># maximum previously simulated nodes for indicator kriging</span>
<span class="n">nxdis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nydis</span> <span class="o">=</span> <span class="mi">1</span>                                          <span class="c1"># block kriging discretizations</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mi">999</span>                                       <span class="c1"># data trimming limits</span>

<span class="n">varios</span> <span class="o">=</span> <span class="p">[]</span>                                                   <span class="c1"># the variogram list</span>
<span class="n">varios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">azi1</span><span class="o">=</span><span class="n">azi_facies</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">hmaj_facies</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">hmin_facies</span><span class="p">))</span> <span class="c1"># shale ind. vario.</span>
<span class="n">varios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">azi1</span><span class="o">=</span><span class="n">azi_facies</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">hmaj_facies</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">hmin_facies</span><span class="p">))</span> <span class="c1"># sand ind. vario.</span>

<span class="n">run_model</span> <span class="o">=</span> <span class="kc">True</span>                                              <span class="c1"># run the simulation model</span>
<span class="n">nreal</span> <span class="o">=</span> <span class="mi">9</span>                                                     <span class="c1"># number of realizations</span>

<span class="k">if</span> <span class="n">run_model</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">sim_facies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nreal</span><span class="p">,</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">]))</span>
    <span class="n">sim_facies</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sisim</span><span class="p">(</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">ivtype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">koption</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ncut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">thresh</span><span class="o">=</span><span class="n">thresh</span><span class="p">,</span><span class="n">gcdf</span><span class="o">=</span><span class="n">gcdf_facies</span><span class="p">,</span><span class="n">trend</span><span class="o">=</span><span class="n">dummy_trend</span><span class="p">,</span>
               <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">middle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mpar</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">nreal</span><span class="o">=</span><span class="n">nreal</span><span class="p">,</span><span class="n">nx</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span><span class="n">xmn</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">],</span><span class="n">xsiz</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">ymn</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">],</span><span class="n">ysiz</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">],</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">,</span>
               <span class="n">ndmin</span><span class="o">=</span><span class="n">ndmin</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="n">ndmax</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="n">nodmax</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">varios</span><span class="p">)</span>

<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">nreal</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>                          <span class="c1"># adjust plot for the number of realizations</span>
<span class="k">for</span> <span class="n">ireal</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nreal</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  
    <span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">sim_facies</span><span class="p">[</span><span class="n">ireal</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="o">-</span><span class="mf">.4</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">df_12</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Sequential Indicator Simulation - Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">cmap_facies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nrow</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e5bbd83ac1e6ad087c451a38264b5cb5c3c8dba90cc0b2de00f4dc3eacede95b.png" src="_images/e5bbd83ac1e6ad087c451a38264b5cb5c3c8dba90cc0b2de00f4dc3eacede95b.png" />
</div>
</div>
</section>
<section id="split-the-dataset-by-facies-and-gaussian-transformation-by-facies">
<h2>Split the Dataset by Facies and Gaussian Transformation By-facies<a class="headerlink" href="#split-the-dataset-by-facies-and-gaussian-transformation-by-facies" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_12_sand</span> <span class="o">=</span> <span class="n">df_12</span><span class="p">[</span><span class="n">df_12</span><span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>                       <span class="c1"># sand facies</span>
<span class="n">df_12_shale</span> <span class="o">=</span> <span class="n">df_12</span><span class="p">[</span><span class="n">df_12</span><span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>                      <span class="c1"># shale facies</span>

<span class="n">df_12_sand</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_12_sand</span><span class="p">,</span> <span class="s1">&#39;Por&#39;</span><span class="p">)</span>   <span class="c1"># Gaussian transformation by-facies</span>
<span class="n">df_12_sand</span><span class="p">[</span><span class="s1">&#39;NPerm&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_12_sand</span><span class="p">,</span> <span class="s1">&#39;Perm&#39;</span><span class="p">)</span>   
<span class="n">df_12_shale</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_12_shale</span><span class="p">,</span> <span class="s1">&#39;Por&#39;</span><span class="p">)</span>   
<span class="n">df_12_shale</span><span class="p">[</span><span class="s1">&#39;NPerm&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_12_shale</span><span class="p">,</span> <span class="s1">&#39;Perm&#39;</span><span class="p">)</span>   

<span class="n">features_mat</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Por&#39;</span><span class="p">,</span><span class="s1">&#39;Perm&#39;</span><span class="p">];</span> <span class="n">facies_mat</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Shale&#39;</span><span class="p">,</span><span class="s1">&#39;Sand&#39;</span><span class="p">]</span> <span class="c1"># location maps</span>
<span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features_mat</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ifacies</span><span class="p">,</span> <span class="n">facies</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Shale&#39;</span><span class="p">:</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_shale</span>
        <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Sand&#39;</span><span class="p">:</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_sand</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ifacies</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df_temp</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="o">+</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;fname&quot;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span>
            <span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">facies</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Well Data Location Map&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span>
            <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;colormap&quot;</span><span class="p">]);</span> <span class="n">add_grid2</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0308b0c0bdce4e0035a3562a12180078b3a11698c77ff0e489a74cc3d7a6801d.png" src="_images/0308b0c0bdce4e0035a3562a12180078b3a11698c77ff0e489a74cc3d7a6801d.png" />
</div>
</div>
</section>
<section id="calculate-continuous-feature-by-facies-experimental-variograms">
<h2>Calculate Continuous Feature, By-facies Experimental Variograms<a class="headerlink" href="#calculate-continuous-feature-by-facies-experimental-variograms" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display 

<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mf">9999.</span><span class="p">;</span> 
<span class="n">lag_dist</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">;</span> <span class="n">lag_tol</span> <span class="o">=</span> <span class="mf">350.0</span><span class="p">;</span> <span class="n">nlag</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">bandh</span> <span class="o">=</span> <span class="mf">9999.9</span><span class="p">;</span> <span class="n">azi</span> <span class="o">=</span> <span class="mi">165</span><span class="p">;</span> <span class="n">atol</span> <span class="o">=</span> <span class="mf">22.5</span><span class="p">;</span> <span class="n">isill</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">lag_maj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">));</span> <span class="n">gamma_maj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">npair_maj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">lag_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">));</span> <span class="n">gamma_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
<span class="n">npair_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">),</span><span class="n">nlag</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>

<span class="n">nug</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">nst</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">it1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">cc1</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">azi</span> <span class="o">=</span> <span class="mi">165</span> 
<span class="n">maj_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5000</span><span class="p">,</span><span class="mi">3700</span><span class="p">],[</span><span class="mi">2700</span><span class="p">,</span><span class="mi">2800</span><span class="p">]]);</span> <span class="n">min_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2000</span><span class="p">],[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">]])</span>
  
<span class="n">continuous_variograms</span> <span class="o">=</span> <span class="p">[[{}</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features_mat</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features_mat</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ifacies</span><span class="p">,</span> <span class="n">facies</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Shale&#39;</span><span class="p">:</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_shale</span>
        <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Sand&#39;</span><span class="p">:</span>
            <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_sand</span>

        <span class="n">lag_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span> <span class="n">gamma_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span> <span class="n">npair_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df_temp</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="o">+</span><span class="n">feature</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">lag_dist</span><span class="p">,</span><span class="n">lag_tol</span><span class="p">,</span><span class="n">nlag</span><span class="p">,</span><span class="n">azi</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">bandh</span><span class="p">,</span><span class="n">isill</span><span class="p">)</span>
        <span class="n">lag_min</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span> <span class="n">gamma_min</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span> <span class="n">npair_min</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df_temp</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="o">+</span><span class="n">feature</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">lag_dist</span><span class="p">,</span><span class="n">lag_tol</span><span class="p">,</span><span class="n">nlag</span><span class="p">,</span><span class="n">azi</span><span class="o">+</span><span class="mf">90.0</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">bandh</span><span class="p">,</span><span class="n">isill</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="n">ifeature</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ifacies</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lag_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span><span class="n">gamma_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                         <span class="n">s</span><span class="o">=</span><span class="n">npair_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:]</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Major Experimental, Azi = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi</span><span class="p">));</span> <span class="n">add_grid2</span><span class="p">()</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lag_min</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span><span class="n">gamma_min</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;forestgreen&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                         <span class="n">s</span><span class="o">=</span><span class="n">npair_maj</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">,:]</span><span class="o">/</span><span class="mi">17</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minor Experimental, Azi = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi</span><span class="o">+</span><span class="mf">90.0</span><span class="p">));</span> <span class="n">add_grid2</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Twelve: &#39;</span> <span class="o">+</span> <span class="n">facies</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; Well Variogram&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag Distance (m)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Variogram, $\gamma$&#39;</span><span class="p">)</span>


        <span class="n">continuous_variograms</span><span class="p">[</span><span class="n">ifeature</span><span class="p">][</span><span class="n">ifacies</span><span class="p">]</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="p">,</span><span class="n">nst</span><span class="p">,</span><span class="n">it1</span><span class="p">,</span><span class="n">cc1</span><span class="p">,</span><span class="n">azi_facies</span><span class="p">,</span><span class="n">maj_range</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">],</span><span class="n">min_range</span><span class="p">[</span><span class="n">ifeature</span><span class="p">,</span><span class="n">ifacies</span><span class="p">])</span>
        
        <span class="n">nlag_model</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">xlag</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">azm</span> <span class="o">=</span> <span class="n">azi</span>                               <span class="c1"># project the model in the 045 and 135 azimuth</span>
        <span class="n">index_maj</span><span class="p">,</span><span class="n">h_maj</span><span class="p">,</span><span class="n">gam_maj</span><span class="p">,</span><span class="n">cov_maj</span><span class="p">,</span><span class="n">ro_maj</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">vmodel</span><span class="p">(</span><span class="n">nlag_model</span><span class="p">,</span><span class="n">xlag</span><span class="p">,</span><span class="n">azi</span><span class="p">,</span><span class="n">continuous_variograms</span><span class="p">[</span><span class="n">ifeature</span><span class="p">][</span><span class="n">ifacies</span><span class="p">])</span>
        <span class="n">index_min</span><span class="p">,</span><span class="n">h_min</span><span class="p">,</span><span class="n">gam_min</span><span class="p">,</span><span class="n">cov_min</span><span class="p">,</span><span class="n">ro_min</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">vmodel</span><span class="p">(</span><span class="n">nlag_model</span><span class="p">,</span><span class="n">xlag</span><span class="p">,</span><span class="n">azi</span><span class="o">+</span><span class="mi">90</span><span class="p">,</span><span class="n">continuous_variograms</span><span class="p">[</span><span class="n">ifeature</span><span class="p">][</span><span class="n">ifacies</span><span class="p">])</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_maj</span><span class="p">,</span><span class="n">gam_maj</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orangered&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Major Model, Azi &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_min</span><span class="p">,</span><span class="n">gam_min</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;forestgreen&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minor Model, Azi &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">azi</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/09e0851a3f3d3c33690909e7780bef6436d87cb1df0ac6014d4518a44181db80.png" src="_images/09e0851a3f3d3c33690909e7780bef6436d87cb1df0ac6014d4518a44181db80.png" />
</div>
</div>
</section>
<section id="porosity-simulation-by-facies">
<h2>Porosity Simulation By-facies<a class="headerlink" href="#porosity-simulation-by-facies" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>                                                    <span class="c1"># run the realizations, it will likely take minutes to complete</span>

<span class="k">if</span> <span class="n">run</span><span class="p">:</span>
    <span class="n">sim_por</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nreal</span><span class="p">,</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">]))</span>    
    <span class="k">for</span> <span class="n">ifeature</span><span class="p">,</span> <span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features_mat</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ifacies</span><span class="p">,</span> <span class="n">facies</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">facies_mat</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Shale&#39;</span><span class="p">:</span>
                <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_shale</span>
            <span class="k">if</span> <span class="n">facies</span> <span class="o">==</span> <span class="s1">&#39;Sand&#39;</span><span class="p">:</span>
                <span class="n">df_temp</span> <span class="o">=</span> <span class="n">df_12_sand</span>

            <span class="n">sim_por</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sgsim</span><span class="p">(</span><span class="n">df_temp</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="o">+</span><span class="n">feature</span><span class="p">,</span><span class="n">wcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">scol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">itrans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ismooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dftrans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">tcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">twtcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                     <span class="n">zmin</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;min&quot;</span><span class="p">],</span><span class="n">zmax</span><span class="o">=</span><span class="n">twelve</span><span class="p">[</span><span class="n">feature</span><span class="p">][</span><span class="s2">&quot;max&quot;</span><span class="p">],</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">nsim</span><span class="o">=</span><span class="n">nreal</span><span class="p">,</span>
                                     <span class="n">nx</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span><span class="n">xmn</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">],</span><span class="n">xsiz</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">ymn</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">],</span><span class="n">ysiz</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">],</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">ndmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">colocorr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">sec_map</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">continuous_variograms</span><span class="p">[</span><span class="n">ifeature</span><span class="p">][</span><span class="n">ifacies</span><span class="p">])</span>

<span class="c1"># plt.subplot(221)                                              # pixelplot and location map</span>
<span class="c1"># locpix_st(por_sim_one,xmin,xmax,ymin,ymax,xsiz,pormin,pormax,df,&#39;X&#39;,&#39;Y&#39;,&#39;Porosity&#39;,&#39;Sequential Gaussian Simulation Porosity&#39;,&#39;X(m)&#39;,&#39;Y(m)&#39;,&#39;Porosity (%)&#39;,cmap)</span>

<span class="c1"># plt.subplot(222)                                              # histograms</span>
<span class="c1"># plt.hist(df[&#39;Porosity&#39;].values,density=True,bins=np.linspace(pormin,pormax,30),color=&#39;darkorange&#39;,alpha=0.6,edgecolor=&#39;black&#39;,label=&#39;Data&#39;)</span>
<span class="c1"># plt.hist(por_sim_one.flatten(),density=True,bins=np.linspace(pormin,pormax,30),color=&#39;green&#39;,alpha=0.6,edgecolor=&#39;black&#39;,label=&#39;Simulation&#39;)</span>
<span class="c1"># plt.xlabel(&#39;Porosity (%)&#39;); plt.ylabel(&#39;Frequency&#39;); plt.title(&#39;Porosity Histogram&#39;); plt.legend(loc=&#39;upper right&#39;)</span>

<span class="c1"># lags, sim_gamma_maj, npps_maj = geostats.gam(por_sim_one,tmin,tmax,xsiz,ysiz,ixd=1,iyd=-1,nlag=100,isill=0.0);</span>
<span class="c1"># lags, sim_gamma_min, npps_min = geostats.gam(por_sim_one,tmin,tmax,xsiz,ysiz,ixd=1,iyd=1,nlag=100,isill=0.0);</span>

<span class="c1"># plt.subplot(223)                                              # variograms </span>
<span class="c1"># vargplot(&#39;Porosity&#39;,lags,sim_gamma_maj,sim_gamma_min,npps_maj,npps_min,vmodel,azi=0.0,atol=22.5,sill=porvar,</span>
<span class="c1">#         mcolor = &#39;red&#39;, rcolor = &#39;green&#39;,size= 0.05,legend_pos = &#39;lower right&#39;)     # plot the variogram</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 640x480 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### Gaussian Transformation</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span>   <span class="c1"># all </span>
<span class="n">df_sand</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPorSand</span><span class="p">,</span> <span class="n">tnsPorSand</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_sand</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span> <span class="c1"># sand </span>
<span class="n">df_shale</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPorShale</span><span class="p">,</span> <span class="n">tnsPorShale</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_shale</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span> <span class="c1"># shale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#### Gaussian Transformation</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPor</span><span class="p">,</span> <span class="n">tnsPor</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span>   <span class="c1"># all </span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">df_sand</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPorSand</span><span class="p">,</span> <span class="n">tnsPorSand</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_sand</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span> <span class="c1"># sand </span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">df_shale</span><span class="p">[</span><span class="s1">&#39;NPor&#39;</span><span class="p">],</span> <span class="n">tvPorShale</span><span class="p">,</span> <span class="n">tnsPorShale</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">nscore</span><span class="p">(</span><span class="n">df_shale</span><span class="p">,</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span> <span class="c1"># shale</span>

<span class="ne">NameError</span>: name &#39;df&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-limits-for-plotting-colorbars-and-grid-specification">
<h2>Set Limits for Plotting, Colorbars and Grid Specification<a class="headerlink" href="#set-limits-for-plotting-colorbars-and-grid-specification" title="Permalink to this heading">#</a></h2>
<p>Limits are applied for data and model visualization and the grid parameters sets the coverage and resolution of our map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">1000.0</span>                                     <span class="c1"># spatial limits</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1000.0</span>

<span class="n">nx</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">xmn</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span> <span class="n">xsiz</span> <span class="o">=</span> <span class="mf">10.0</span>                              <span class="c1"># grid specification</span>
<span class="n">ny</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">ymn</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span> <span class="n">ysiz</span> <span class="o">=</span> <span class="mf">10.0</span>

<span class="n">pormin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">pormax</span> <span class="o">=</span> <span class="mf">22.0</span>                                   <span class="c1"># feature limits</span>
<span class="n">porvar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>                        <span class="c1"># assume data variance is representative</span>

<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9999.9</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mf">9999.9</span>                                 <span class="c1"># triming limits</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-analytics-and-visualization">
<h2>Data Analytics and Visualization<a class="headerlink" href="#data-analytics-and-visualization" title="Permalink to this heading">#</a></h2>
<p>Let’s take a look at the available data:</p>
<ul class="simple">
<li><p>location map</p></li>
<li><p>histogram</p></li>
<li><p>variogram</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>                                              <span class="c1"># location map</span>
<span class="n">GSLIB</span><span class="o">.</span><span class="n">locmap_st</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="s1">&#39;Porosity Location Map&#39;</span><span class="p">,</span><span class="s1">&#39;X (m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y (m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>                                              <span class="c1"># histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
         <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Porosity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porosity Histogram&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>                                              <span class="c1"># variogram</span>

<span class="n">lags</span><span class="p">,</span> <span class="n">gamma_maj</span><span class="p">,</span> <span class="n">npps_maj</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xlag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">xltol</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">azm</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span><span class="n">bandwh</span><span class="o">=</span><span class="mf">9999.9</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">gamma_min</span><span class="p">,</span> <span class="n">npps_min</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gamv</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xlag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">xltol</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">azm</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span><span class="n">bandwh</span><span class="o">=</span><span class="mf">9999.9</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>

<span class="n">nug</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nst</span> <span class="o">=</span> <span class="mi">2</span>                                              <span class="c1"># 2 nested structure variogram model parameters</span>
<span class="n">it1</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">cc1</span> <span class="o">=</span> <span class="mf">20.0</span><span class="p">;</span> <span class="n">azi1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">hmaj1</span> <span class="o">=</span> <span class="mi">150</span><span class="p">;</span> <span class="n">hmin1</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">it2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">cc2</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span> <span class="n">azi2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">hmaj2</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span> <span class="n">hmin2</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">vmodel</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="p">,</span><span class="n">nst</span><span class="p">,</span><span class="n">it1</span><span class="p">,</span><span class="n">cc1</span><span class="p">,</span><span class="n">azi1</span><span class="p">,</span><span class="n">hmaj1</span><span class="p">,</span><span class="n">hmin1</span><span class="p">,</span><span class="n">it2</span><span class="p">,</span><span class="n">cc2</span><span class="p">,</span><span class="n">azi2</span><span class="p">,</span><span class="n">hmaj2</span><span class="p">,</span><span class="n">hmin2</span><span class="p">);</span> <span class="c1"># make model object</span>
<span class="n">vmodel_sim</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="p">,</span><span class="n">nst</span><span class="p">,</span><span class="n">it1</span><span class="p">,</span><span class="n">cc1</span><span class="o">/</span><span class="p">(</span><span class="n">cc1</span><span class="o">+</span><span class="n">cc2</span><span class="p">),</span><span class="n">azi1</span><span class="p">,</span><span class="n">hmaj1</span><span class="p">,</span><span class="n">hmin1</span><span class="p">,</span><span class="n">it2</span><span class="p">,</span><span class="n">cc2</span><span class="o">/</span><span class="p">(</span><span class="n">cc1</span><span class="o">+</span><span class="n">cc2</span><span class="p">),</span><span class="n">azi2</span><span class="p">,</span><span class="n">hmaj2</span><span class="p">,</span><span class="n">hmin2</span><span class="p">);</span> <span class="c1"># make model object</span>

<span class="n">vargplot</span><span class="p">(</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">lags</span><span class="p">,</span><span class="n">gamma_maj</span><span class="p">,</span><span class="n">gamma_min</span><span class="p">,</span><span class="n">npps_maj</span><span class="p">,</span><span class="n">npps_min</span><span class="p">,</span><span class="n">vmodel</span><span class="p">,</span><span class="n">azi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span><span class="n">sill</span><span class="o">=</span><span class="n">porvar</span><span class="p">,</span><span class="n">mcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">rcolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
         <span class="n">legend_pos</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>                            <span class="c1"># plot the variogram</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simple-kriging">
<h2>Simple Kriging<a class="headerlink" href="#simple-kriging" title="Permalink to this heading">#</a></h2>
<p>Let’s specify the variogram model, global stationary mean and variance, and kriging parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">vrange_maj</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span> <span class="n">vrange_min</span> <span class="o">=</span> <span class="mi">100</span>                            <span class="c1"># variogram ranges</span>
<span class="n">vazi</span> <span class="o">=</span> <span class="mf">150.0</span>                                                  <span class="c1"># variogram major direction</span>
<span class="n">vrel_nugget</span> <span class="o">=</span> <span class="mf">0.0</span>                                             <span class="c1"># variogram nugget effect</span>

<span class="n">skmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>                    <span class="c1"># assume global mean is the mean of the sample</span>
<span class="n">sill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>                          <span class="c1"># assume sill is variance of the sample</span>

<span class="n">por_vario</span> <span class="o">=</span> <span class="n">GSLIB</span><span class="o">.</span><span class="n">make_variogram</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="n">vrel_nugget</span><span class="o">*</span><span class="n">sill</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">vrel_nugget</span><span class="p">)</span><span class="o">*</span><span class="n">sill</span><span class="p">,</span>
         <span class="n">azi1</span><span class="o">=</span><span class="n">vazi</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">vrange_maj</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">vrange_min</span><span class="p">)</span>         <span class="c1"># porosity variogram</span>

<span class="n">ktype</span> <span class="o">=</span> <span class="mi">0</span>                                                     <span class="c1"># kriging type, 0 - simple, 1 - ordinary</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mi">600</span>                                                  <span class="c1"># search radius for neighbouring data</span>
<span class="n">nxdis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nydis</span> <span class="o">=</span> <span class="mi">1</span>                                          <span class="c1"># number of grid discretizations for block kriging</span>
<span class="n">ndmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ndmax</span> <span class="o">=</span> <span class="mi">10</span>                                         <span class="c1"># minimum and maximum data for an estimate</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s pass this to kriging to make our porosity kriging estimate map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">por_kmap</span><span class="p">,</span> <span class="n">por_vmap</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">kb2d</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">xmn</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">ymn</span><span class="p">,</span><span class="n">ysiz</span><span class="p">,</span><span class="n">nxdis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nydis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
         <span class="n">ndmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">skmean</span><span class="o">=</span><span class="n">skmean</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">vmodel</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>                                              <span class="c1"># kriging estimation map</span>
<span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">por_kmap</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Simple Kriging Porosity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>                                              <span class="c1"># kriging variance map</span>
<span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">por_vmap</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">sill</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Simple Kriging Variance&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Kriging Variance (%^2)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>                                              <span class="c1"># histograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">por_kmap</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Kriging&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porosity Histogram&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">lags</span><span class="p">,</span> <span class="n">sk_gamma_maj</span><span class="p">,</span> <span class="n">npps_maj</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gam</span><span class="p">(</span><span class="n">por_kmap</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ysiz</span><span class="p">,</span><span class="n">ixd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iyd</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">sk_gamma_min</span><span class="p">,</span> <span class="n">npps_min</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gam</span><span class="p">(</span><span class="n">por_kmap</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ysiz</span><span class="p">,</span><span class="n">ixd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iyd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>                                               <span class="c1"># experimental variograms</span>
<span class="n">vargplot</span><span class="p">(</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">lags</span><span class="p">,</span><span class="n">sk_gamma_maj</span><span class="p">,</span><span class="n">sk_gamma_min</span><span class="p">,</span><span class="n">npps_maj</span><span class="p">,</span><span class="n">npps_min</span><span class="p">,</span><span class="n">vmodel</span><span class="p">,</span><span class="n">azi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span><span class="n">sill</span><span class="o">=</span><span class="n">porvar</span><span class="p">,</span>
         <span class="n">mcolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">rcolor</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">legend_pos</span> <span class="o">=</span> <span class="s1">&#39;upper right&#39;</span><span class="p">)</span>                <span class="c1"># plot the variogram</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sequential-gaussian-simulation">
<h2>Sequential Gaussian Simulation<a class="headerlink" href="#sequential-gaussian-simulation" title="Permalink to this heading">#</a></h2>
<p>Let’s jump right to building a variety of models with simulation and visualizing the results.  We will start with a test, comparasion of simulation with simple and ordinary kriging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>                                                    <span class="c1"># run the realizations, it will likely take minutes to complete</span>

<span class="k">if</span> <span class="n">run</span><span class="p">:</span>
    <span class="n">por_sim_one</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sgsim</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">wcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">scol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">itrans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ismooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dftrans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">tcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">twtcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">nsim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">xmn</span><span class="o">=</span><span class="n">xmn</span><span class="p">,</span><span class="n">xsiz</span><span class="o">=</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">ymn</span><span class="o">=</span><span class="n">ymn</span><span class="p">,</span><span class="n">ysiz</span><span class="o">=</span><span class="n">ysiz</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">73073</span><span class="p">,</span>
            <span class="n">ndmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">colocorr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">sec_map</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">vmodel_sim</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>                                              <span class="c1"># pixelplot and location map</span>
<span class="n">locpix_st</span><span class="p">(</span><span class="n">por_sim_one</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Sequential Gaussian Simulation Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>                                              <span class="c1"># histograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">por_sim_one</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porosity Histogram&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">lags</span><span class="p">,</span> <span class="n">sim_gamma_maj</span><span class="p">,</span> <span class="n">npps_maj</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gam</span><span class="p">(</span><span class="n">por_sim_one</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ysiz</span><span class="p">,</span><span class="n">ixd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iyd</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span>
<span class="n">lags</span><span class="p">,</span> <span class="n">sim_gamma_min</span><span class="p">,</span> <span class="n">npps_min</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">gam</span><span class="p">(</span><span class="n">por_sim_one</span><span class="p">,</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ysiz</span><span class="p">,</span><span class="n">ixd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">iyd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nlag</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">isill</span><span class="o">=</span><span class="mf">0.0</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>                                              <span class="c1"># variograms </span>
<span class="n">vargplot</span><span class="p">(</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">lags</span><span class="p">,</span><span class="n">sim_gamma_maj</span><span class="p">,</span><span class="n">sim_gamma_min</span><span class="p">,</span><span class="n">npps_maj</span><span class="p">,</span><span class="n">npps_min</span><span class="p">,</span><span class="n">vmodel</span><span class="p">,</span><span class="n">azi</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">22.5</span><span class="p">,</span><span class="n">sill</span><span class="o">=</span><span class="n">porvar</span><span class="p">,</span>
        <span class="n">mcolor</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">rcolor</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span><span class="n">legend_pos</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>     <span class="c1"># plot the variogram</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-simulated-realizations-and-a-kriged-estimation-model">
<h2>Visualize Simulated Realizations and a Kriged Estimation Model<a class="headerlink" href="#visualize-simulated-realizations-and-a-kriged-estimation-model" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display     

<span class="n">run</span> <span class="o">=</span> <span class="kc">True</span>                                                    <span class="c1"># run the realizations, it will likely take minutes to complete                                            </span>
<span class="k">if</span> <span class="n">run</span><span class="p">:</span>
    <span class="n">por_sim</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sgsim</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">wcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">scol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">itrans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ismooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dftrans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">tcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">twtcol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">nsim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span><span class="n">xmn</span><span class="o">=</span><span class="n">xmn</span><span class="p">,</span><span class="n">xsiz</span><span class="o">=</span><span class="n">xsiz</span><span class="p">,</span><span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span><span class="n">ymn</span><span class="o">=</span><span class="n">ymn</span><span class="p">,</span><span class="n">ysiz</span><span class="o">=</span><span class="n">ysiz</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">73073</span><span class="p">,</span>
            <span class="n">ndmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">colocorr</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">sec_map</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">vmodel_sim</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>                                              <span class="c1"># pixelplot and location map</span>
<span class="n">locpix_st</span><span class="p">(</span><span class="n">por_sim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity Realization #1&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>                                              <span class="c1"># pixelplot and location map</span>
<span class="n">locpix_st</span><span class="p">(</span><span class="n">por_sim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity Realization #2&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>                                              <span class="c1"># pixelplot and location map</span>
<span class="n">locpix_st</span><span class="p">(</span><span class="n">por_sim</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity Realizations #3&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>                                              <span class="c1"># pixelplot and location map</span>
<span class="n">locpix_st</span><span class="p">(</span><span class="n">por_kmap</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">xsiz</span><span class="p">,</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity Estimation&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity (%)&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">2.1</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="comments">
<h2>Comments<a class="headerlink" href="#comments" title="Permalink to this heading">#</a></h2>
<p>This was a basic demonstration and comparison of spatial estimation vs. spatial simulation with kriging and sequential Gaussian simulation from GeostatsPy. Much more can be done, I have other demonstrations for modeling workflows with GeostatsPy in the GitHub repository <a class="reference external" href="https://github.com/GeostatsGuy/GeostatsPy_Demos/tree/main">GeostatsPy_Demos</a>.</p>
<p>I hope this is helpful,</p>
<p><em>Michael</em></p>
</section>
<section id="about-the-author">
<h2>About the Author<a class="headerlink" href="#about-the-author" title="Permalink to this heading">#</a></h2>
<figure style="text-align: center;">
  <img src="_static/intro/michael_pyrcz_officeshot_jacket.jpg" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Professor Michael Pyrcz in his office on the 40 acres, campus of The University of Texas at Austin.
</figcaption>
</figure>
<p>Michael Pyrcz is a professor in the <a class="reference external" href="https://cockrell.utexas.edu/faculty-directory/alphabetical/p">Cockrell School of Engineering</a>, and the <a class="reference external" href="https://www.jsg.utexas.edu/researcher/michael_pyrcz/">Jackson School of Geosciences</a>, at <a class="reference external" href="https://www.utexas.edu/">The University of Texas at Austin</a>, where he researches and teaches subsurface, spatial data analytics, geostatistics, and machine learning. Michael is also,</p>
<ul class="simple">
<li><p>the principal investigator of the <a class="reference external" href="https://fri.cns.utexas.edu/energy-analytics">Energy Analytics</a> freshmen research initiative and a core faculty in the Machine Learn Laboratory in the College of Natural Sciences, The University of Texas at Austin</p></li>
<li><p>an associate editor for <a class="reference external" href="https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board">Computers and Geosciences</a>, and a board member for <a class="reference external" href="https://link.springer.com/journal/11004/editorial-board">Mathematical Geosciences</a>, the International Association for Mathematical Geosciences.</p></li>
</ul>
<p>Michael has written over 70 <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en">peer-reviewed publications</a>, a <a class="reference external" href="https://pypi.org/project/geostatspy/">Python package</a> for spatial data analytics, co-authored a textbook on spatial data analytics, <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistical Reservoir Modeling</a> and author of two recently released e-books, <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</a> and <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html">Applied Machine Learning in Python: a Hands-on Guide with Code</a>.</p>
<p>All of Michael’s university lectures are available on his <a class="reference external" href="https://www.youtube.com/&#64;GeostatsGuyLectures">YouTube Channel</a> with links to 100s of Python interactive dashboards and well-documented workflows in over 40 repositories on his <a class="reference external" href="https://github.com/GeostatsGuy">GitHub account</a>, to support any interested students and working professionals with evergreen content. To find out more about Michael’s work and shared educational resources visit his <span class="xref myst">Website</span>.</p>
</section>
<section id="want-to-work-together">
<h2>Want to Work Together?<a class="headerlink" href="#want-to-work-together" title="Permalink to this heading">#</a></h2>
<p>I hope this content is helpful to those that want to learn more about subsurface modeling, data analytics and machine learning. Students and working professionals are welcome to participate.</p>
<ul class="simple">
<li><p>Want to invite me to visit your company for training, mentoring, project review, workflow design and / or consulting? I’d be happy to drop by and work with you!</p></li>
<li><p>Interested in partnering, supporting my graduate student research or my Subsurface Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)? My research combines data analytics, stochastic modeling and machine learning theory with practice to develop novel methods and workflows to add value. We are solving challenging subsurface problems!</p></li>
<li><p>I can be reached at <a class="reference external" href="mailto:mpyrcz&#37;&#52;&#48;austin&#46;utexas&#46;edu">mpyrcz<span>&#64;</span>austin<span>&#46;</span>utexas<span>&#46;</span>edu</a>.</p></li>
</ul>
<p>I’m always happy to discuss,</p>
<p><em>Michael</em></p>
<p>Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The Jackson School of Geosciences, The University of Texas at Austin</p>
<p>More Resources Available at: <a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-for-a-complete-demonstration-workflow">Motivation for a Complete Demonstration Workflow.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spatial-modeling-workflow-steps">Spatial Modeling Workflow Steps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-required-libraries">Load the Required Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-custom-colorbar">Make Custom Colorbar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-the-working-directory">Set the Working Directory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-tabular-and-gridded-datasets">Load Tabular and Gridded Datasets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-and-grid-dictionary">Dataset and Grid Dictionary</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-dataset">Visualize the Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#univariate-analysis">Univariate Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debiasing-the-distributions">Debiasing the Distributions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicator-facies-variograms">Indicator Facies Variograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indicator-simulation-of-facies">Indicator Simulation of Facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-the-dataset-by-facies-and-gaussian-transformation-by-facies">Split the Dataset by Facies and Gaussian Transformation By-facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-continuous-feature-by-facies-experimental-variograms">Calculate Continuous Feature, By-facies Experimental Variograms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#porosity-simulation-by-facies">Porosity Simulation By-facies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-limits-for-plotting-colorbars-and-grid-specification">Set Limits for Plotting, Colorbars and Grid Specification</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-analytics-and-visualization">Data Analytics and Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-kriging">Simple Kriging</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-gaussian-simulation">Sequential Gaussian Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-simulated-realizations-and-a-kriged-estimation-model">Visualize Simulated Realizations and a Kriged Estimation Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael J. Pyrcz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>