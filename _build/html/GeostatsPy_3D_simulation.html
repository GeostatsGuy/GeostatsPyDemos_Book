

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3D Simulation &#8212; GeostatsPy Well-documented Demonstration Geostatistical Workflows</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'GeostatsPy_3D_simulation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cosimulation" href="GeostatsPy_cosimulation.html" />
    <link rel="prev" title="Indicator Simulation" href="GeostatsPy_categorical_indicator_simulation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/AppliedGeostats.jpg" class="logo__image only-light" alt="GeostatsPy Well-documented Demonstration Geostatistical Workflows - Home"/>
    <script>document.write(`<img src="_static/AppliedGeostats.jpg" class="logo__image only-dark" alt="GeostatsPy Well-documented Demonstration Geostatistical Workflows - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_concepts.html">Geostatistical Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_probability.html">Probability Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_coordinate_transformations.html">Coordinate Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_univariate_statistics.html">Univariate Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_univariate_distributions.html">Univariate Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_parametric_distributions.html">Parametric Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_parametric_distributions_fitting.html">Parametric Distributions Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_expectation.html">Statistical Expectation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_monte_carlo_simulation.html">Monte Carlo Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_transformations.html">Distribution Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_heterogeneity_metrics.html">Spatial Heterogeneity Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_confidence_interval.html">Confidence Intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_hypothesis_testing.html">Hypothesis Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_bivariate.html">Bivariate Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_QQ.html">QQ-Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_linear_regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_plotting_spatial_data_models.html">Plotting Spatial Data and Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_bootstrap.html">Bootstrap Uncertainty Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_declustering.html">Declustering to Debias Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_declustering_all_methods.html">Advanced Declustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_calculation.html">Variogram Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_models.html">Variogram Positive Definite Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_models_simulation.html">Variogram Models, Simulation Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_calculation_and_modeling.html">Variogram Calculation and Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_variogram_from_image.html">Variogram Calculation from an Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_trends.html">Trend Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_2D1D_trend.html">Spatial Trend Modeling, 1D + 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_inv_distance.html">Inverse Distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging.html">Simple and Ordinary Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_categorical_indictor_kriging.html">Indicator Kriging</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_simulation.html">Stochastic Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging_vs_simulation_1D.html">Kriging vs. Simulation, 1D</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_kriging_vs_simulation_maps.html">Kriging vs. Simulation, 2D Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_categorical_indicator_simulation.html">Indicator Simulation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3D Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_cosimulation.html">Cosimulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_ergodic_fluctuations.html">Ergodic Fluctuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_simulation_postsim.html">Simulation Post-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_model_checking.html">Model Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_volume_variance.html">Volume-Variance Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_decision_making.html">Decision Making with Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_datasets.html">Synthetic Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy.html">GeostatsPy Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusions.html">Conclusions</a></li>
<li class="toctree-l1"><a class="reference internal" href="GeostatsPy_glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/GeostatsPyDemos_Book/issues/new?title=Issue%20on%20page%20%2FGeostatsPy_3D_simulation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/GeostatsPy_3D_simulation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3D Simulation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geostatistics-in-3d">Geostatistics in 3D</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-custom-colorbar">Make Custom Colorbar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-the-3d-grid">Specify the 3D Grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-synthetic-data">Make Synthetic Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sisim-3d-demonstration">SISIM 3D Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sgsim-3d-demonstration">SGSIM 3D Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <figure style="text-align: center;">
  <img src="_static/intro/title_page.png" style="display: block; margin: 0 auto; width: 100%;">
</figure>
<section id="d-simulation">
<h1>3D Simulation<a class="headerlink" href="#d-simulation" title="Permalink to this heading">#</a></h1>
<p>Michael J. Pyrcz, Professor, The University of Texas at Austin</p>
<p><a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
<p>Chapter of e-book “Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy”.</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite this e-Book as:</p>
<p>Pyrcz, M.J., 2024, <em>Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</em> [e-book]. Zenodo. doi:10.5281/zenodo.15169133 <a class="reference external" href="https://doi.org/10.5281/zenodo.15169132"><img alt="DOI" src="https://zenodo.org/badge/838927017.svg" /></a></p>
</div>
<p>The workflows in this book and more are available here:</p>
<div class="remove-from-content-only admonition">
<p class="admonition-title">Cite the GeostatsPyDemos GitHub Repository as:</p>
<p>Pyrcz, M.J., 2024, <em>GeostatsPyDemos: GeostatsPy Python Package for Spatial Data Analytics and Geostatistics Demonstration Workflows Repository</em> (0.0.1) [Software]. Zenodo. doi:10.5281/zenodo.12667036. GitHub Repository: <a class="github reference external" href="https://github.com/GeostatsGuy/GeostatsPyDemos">GeostatsGuy/GeostatsPyDemos</a> <a class="reference external" href="https://doi.org/10.5281/zenodo.12667035"><img alt="DOI" src="https://zenodo.org/badge/777871341.svg" /></a></p>
</div>
<p>By Michael J. Pyrcz <br />
© Copyright 2024.</p>
<p>This chapter is a tutorial for / demonstration of <strong>3D simulation</strong> with GeostatsPy. This includes codes and a demonstration with,</p>
<ol class="arabic simple">
<li><p>defining the 3D variogram models</p></li>
<li><p>3D sequential indicator simulation</p></li>
<li><p>3D sequential Gaussian simulation</p></li>
</ol>
<p>For the theory with links to my record lectures see the previous 2D modeling chapters,</p>
<ul class="simple">
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_variogram_calculation.html">variogram calculation</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_variogram_calculation_and_modeling.html">variogram modeling</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_simulation.html">sequential Gaussian simulation</a></p></li>
<li><p><a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/GeostatsPy_categorical_indicator_simulation.html">sequential indicator simulation</a></p></li>
</ul>
<p>In these chapters you will get all of the needed theory and demonstrations.</p>
<section id="geostatistics-in-3d">
<h2>Geostatistics in 3D<a class="headerlink" href="#geostatistics-in-3d" title="Permalink to this heading">#</a></h2>
<p>I have a confession: many of the GSLIB functions in the GeostatsPy Python package were ported or written from scratch by me, often late at night and into the early morning hours, just in time for the next day’s lecture.</p>
<p>Back in 2018, I desperately needed a usable, open-source geostatistics Python package to teach my courses. I found one, but on the first day of the semester, it broke due to an update in a dependent package. With no alternatives, I decided to build my own. My goal was simple,</p>
<ul class="simple">
<li><p>implement the minimum necessary tools to teach geostatistics in practice, not just in theory.</p></li>
</ul>
<p>Because:</p>
<ul class="simple">
<li><p>you can’t teach geostatistics without algorithms</p></li>
<li><p>students weren’t going to edit parameter files and run old FORTRAN GSLIB executables. (I tried that once—many students dropped the course in the first week!)</p></li>
<li><p>my Excel demonstrations are great for theory and math, but they don’t support building full models.</p></li>
</ul>
<p>So, in those early days, I made a key decision, everything would be in 2D only. Why?</p>
<ul class="simple">
<li><p>there is less urgency for streamlined, optimized codes.</p></li>
<li><p>it made testing and debugging much easier.</p></li>
<li><p>it was perfect for live demos and slides, easy to explain, visualize, and diagnose.</p></li>
</ul>
<p>Fast forward to now… I’m lucky to have an amazing graduate student team—typically 12–15 students, mostly PhDs—and many of them want to build 3D geostatistical models. So, I couldn’t help myself. I went back and updated every function, search algorithms, kriging, distance metrics with geometric anisotropy, and more… and finally,</p>
<ul class="simple">
<li><p>sgsim_3D - a 3D implementation of sequential Gaussian simulation</p></li>
<li><p>sisim_3D - a 3D implementation of sequential indicator simulation</p></li>
</ul>
<p>In the spirit of package documentation, I have converted my testing workflow into this e-book chapter, but I must include a warning. This is the initial version of these 2 3D algorithms with minimal testing. I have tested,</p>
<ul class="simple">
<li><p>simple and ordinary kriging</p></li>
<li><p>stationary mean or proportion realizations</p></li>
<li><p>data conditioning</p></li>
</ul>
<p>but I have not yet tested,</p>
<ul class="simple">
<li><p>locally variable mean / proportion</p></li>
<li><p>collocated cokriging</p></li>
</ul>
<p>For large 3D models, I still recommend the GSLIB wrappers in the GSLIB module of GeostatsPy,</p>
<ul class="simple">
<li><p>GSLIB.sgsim_3D - writes out a GSLIB .par file, executes the sgsim.exe and then reads the output back as a 3D ndarray.</p></li>
<li><p>GSLIB.sisim_3D (TO BE ADDED SOON) - writes out a GSLIB .par file, executes the sisim.exe and then reads the output back as a 3D ndarray.</p></li>
</ul>
<p>In my experience, the Python implementation of GeostatsPy cannot compete with the speed original FORTRAN GSLIB for large models!</p>
<p>I hope this is helpful, I welcome any bug reports or suggestions,</p>
<p>Michael</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geostatspy.GSLIB</span> <span class="k">as</span> <span class="nn">GSLIB</span>                              <span class="c1"># we just need the plotting methods</span>
<span class="kn">import</span> <span class="nn">geostatspy.geostats</span> <span class="k">as</span> <span class="nn">geostats</span>                        <span class="c1"># we just need the method for making variogram     </span>
<span class="kn">import</span> <span class="nn">geostatspy</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GeostatsPy version: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">geostatspy</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GeostatsPy version: 0.0.78
</pre></div>
</div>
</div>
</div>
<p>We will also need some standard packages. These should have been installed with Anaconda 3.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>                                                     <span class="c1"># set working directory, run executables</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>                                         <span class="c1"># suppress the status bar</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partialmethod</span>
<span class="n">tqdm</span><span class="o">.</span><span class="fm">__init__</span> <span class="o">=</span> <span class="n">partialmethod</span><span class="p">(</span><span class="n">tqdm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ignore_warnings</span> <span class="o">=</span> <span class="kc">True</span>                                        <span class="c1"># ignore warnings?</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                                            <span class="c1"># ndarrays for gridded data</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>                                           <span class="c1"># DataFrames for tabular data</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>                               <span class="c1"># for plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span> <span class="k">as</span> <span class="nn">gridspec</span>                        <span class="c1"># flexible subplots</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>                                      <span class="c1"># custom colorbar</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>                       <span class="c1"># 3D plotting</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">AutoMinorLocator</span><span class="p">)</span> <span class="c1"># control of axes ticks</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                                <span class="c1"># plot all grids below the plot elements</span>
<span class="k">if</span> <span class="n">ignore_warnings</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>                                   
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span>                                         <span class="c1"># color map</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-custom-colorbar">
<h2>Make Custom Colorbar<a class="headerlink" href="#make-custom-colorbar" title="Permalink to this heading">#</a></h2>
<p>We make this colorbar to display our categorical, sand and shale facies.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap_facies</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="s1">&#39;gold&#39;</span><span class="p">])</span>
<span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">);</span> <span class="n">cmap_facies</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="declare-functions">
<h2>Declare Functions<a class="headerlink" href="#declare-functions" title="Permalink to this heading">#</a></h2>
<p>Here’s some convience functions to support this demonstration workflow,</p>
<ul class="simple">
<li><p>adding gridlines to our plots</p></li>
<li><p>making a 3D grid parameter dictionary</p></li>
<li><p>making a set of center slice plots with annotation for our 3D models</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_grid</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="c1"># add y grids</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="mi">7</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">());</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">AutoMinorLocator</span><span class="p">())</span> <span class="c1"># turn on minor ticks</span>

<span class="k">def</span> <span class="nf">make_grid_3D</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">nz</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a 3D grid dictionary with GEODAS-style parameters and computed extents.</span>

<span class="sd">    Args:</span>
<span class="sd">        xmin, xmax, nx: Grid min, max and number of cells in X</span>
<span class="sd">        ymin, ymax, ny: Grid min, max and number of cells in Y</span>
<span class="sd">        zmin, zmax, nz: Grid min, max and number of cells in Z</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict containing:</span>
<span class="sd">            - xsiz, ysiz, zsiz</span>
<span class="sd">            - nx, ny, nz</span>
<span class="sd">            - xmn, ymn, zmn (center of first cell)</span>
<span class="sd">            - xmin, xmax, ymin, ymax, zmin, zmax (computed extents)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">xmax</span> <span class="o">&gt;</span> <span class="n">xmin</span> <span class="ow">and</span> <span class="n">nx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Invalid x-dimension parameters&quot;</span> <span class="c1"># validate input</span>
    <span class="k">assert</span> <span class="n">ymax</span> <span class="o">&gt;</span> <span class="n">ymin</span> <span class="ow">and</span> <span class="n">ny</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Invalid y-dimension parameters&quot;</span>
    <span class="k">assert</span> <span class="n">zmax</span> <span class="o">&gt;</span> <span class="n">zmin</span> <span class="ow">and</span> <span class="n">nz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Invalid z-dimension parameters&quot;</span>

    <span class="n">xsiz</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nx</span>                                 <span class="c1"># compute cell sizes</span>
    <span class="n">ysiz</span> <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span> <span class="o">/</span> <span class="n">ny</span>
    <span class="n">zsiz</span> <span class="o">=</span> <span class="p">(</span><span class="n">zmax</span> <span class="o">-</span> <span class="n">zmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">nz</span>

    <span class="n">xmn</span> <span class="o">=</span> <span class="n">xmin</span> <span class="o">+</span> <span class="n">xsiz</span> <span class="o">*</span> <span class="mf">0.5</span>                                   <span class="c1"># compute centers of first cells (GEODAS-style)</span>
    <span class="n">ymn</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="n">ysiz</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">zmn</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">zsiz</span> <span class="o">*</span> <span class="mf">0.5</span>

    <span class="n">xmin_calc</span> <span class="o">=</span> <span class="n">xmn</span> <span class="o">-</span> <span class="n">xsiz</span> <span class="o">*</span> <span class="mf">0.5</span>                              <span class="c1"># recalculate extents from cell-center origin for consistency</span>
    <span class="n">xmax_calc</span> <span class="o">=</span> <span class="n">xmin_calc</span> <span class="o">+</span> <span class="n">nx</span> <span class="o">*</span> <span class="n">xsiz</span>

    <span class="n">ymin_calc</span> <span class="o">=</span> <span class="n">ymn</span> <span class="o">-</span> <span class="n">ysiz</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">ymax_calc</span> <span class="o">=</span> <span class="n">ymin_calc</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">ysiz</span>

    <span class="n">zmin_calc</span> <span class="o">=</span> <span class="n">zmn</span> <span class="o">-</span> <span class="n">zsiz</span> <span class="o">*</span> <span class="mf">0.5</span>
    <span class="n">zmax_calc</span> <span class="o">=</span> <span class="n">zmin_calc</span> <span class="o">+</span> <span class="n">nz</span> <span class="o">*</span> <span class="n">zsiz</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;xsiz&#39;</span><span class="p">:</span> <span class="n">xsiz</span><span class="p">,</span> <span class="s1">&#39;ysiz&#39;</span><span class="p">:</span> <span class="n">ysiz</span><span class="p">,</span> <span class="s1">&#39;zsiz&#39;</span><span class="p">:</span> <span class="n">zsiz</span><span class="p">,</span>             <span class="c1"># cell sizes</span>
        <span class="s1">&#39;nx&#39;</span><span class="p">:</span> <span class="n">nx</span><span class="p">,</span> <span class="s1">&#39;ny&#39;</span><span class="p">:</span> <span class="n">ny</span><span class="p">,</span> <span class="s1">&#39;nz&#39;</span><span class="p">:</span> <span class="n">nz</span><span class="p">,</span>                         <span class="c1"># cell counts</span>
        <span class="s1">&#39;xmn&#39;</span><span class="p">:</span> <span class="n">xmn</span><span class="p">,</span> <span class="s1">&#39;ymn&#39;</span><span class="p">:</span> <span class="n">ymn</span><span class="p">,</span> <span class="s1">&#39;zmn&#39;</span><span class="p">:</span> <span class="n">zmn</span><span class="p">,</span>                   <span class="c1"># origins (center of first cell)</span>
        <span class="s1">&#39;xmin&#39;</span><span class="p">:</span> <span class="n">xmin_calc</span><span class="p">,</span> <span class="s1">&#39;xmax&#39;</span><span class="p">:</span> <span class="n">xmax_calc</span><span class="p">,</span>                 <span class="c1"># calculated extents</span>
        <span class="s1">&#39;ymin&#39;</span><span class="p">:</span> <span class="n">ymin_calc</span><span class="p">,</span> <span class="s1">&#39;ymax&#39;</span><span class="p">:</span> <span class="n">ymax_calc</span><span class="p">,</span>
        <span class="s1">&#39;zmin&#39;</span><span class="p">:</span> <span class="n">zmin_calc</span><span class="p">,</span> <span class="s1">&#39;zmax&#39;</span><span class="p">:</span> <span class="n">zmax_calc</span>
    <span class="p">}</span>

<span class="k">def</span> <span class="nf">plot_center_slices_3D</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="n">grd3D</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">feature</span><span class="p">,</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">nvbin</span><span class="p">,</span><span class="n">cmap</span><span class="p">):</span>
    <span class="n">icx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icx</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">]</span> <span class="c1"># center layers and slices for plotting</span>
    <span class="n">icy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">])</span>
    <span class="n">icz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cz</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icz</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zsiz&#39;</span><span class="p">]</span>                    
    
    <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>         <span class="c1"># wider column on the left</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>                           <span class="c1"># left column, spans both rows</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>                           <span class="c1"># top right</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>                           <span class="c1"># bottom right</span>
    
    <span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">icz</span><span class="p">],</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]],</span> 
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; - iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icz</span><span class="p">));</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (m)&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y (m)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]],[</span><span class="n">cy</span><span class="p">,</span><span class="n">cy</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cx</span><span class="p">,</span><span class="n">cx</span><span class="p">],[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;ix = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icx</span><span class="p">),[</span><span class="n">cx</span><span class="p">,</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.91</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">])],</span> <span class="n">rotation</span><span class="o">=</span> <span class="mf">90.0</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;iy = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icy</span><span class="p">),[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]),</span><span class="n">cy</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="n">vmax</span><span class="p">,</span><span class="n">nvbin</span><span class="p">));</span> <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    
    <span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">array</span><span class="p">[:,:,</span><span class="n">icx</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]],</span> 
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span><span class="n">aspect</span> <span class="o">=</span> <span class="mf">30.0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; - ix = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icx</span><span class="p">));</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]],[</span><span class="n">cz</span><span class="p">,</span><span class="n">cz</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cx</span><span class="p">,</span><span class="n">cx</span><span class="p">],[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icz</span><span class="p">),[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]),</span><span class="n">cz</span><span class="p">])</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;iy = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icy</span><span class="p">),[</span><span class="n">cy</span><span class="p">,</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">])],</span> <span class="n">rotation</span><span class="o">=</span> <span class="mf">90.0</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Y (m)&#39;</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Z (m)&#39;</span><span class="p">)</span>
    
    <span class="n">im3</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">[:,</span><span class="n">icy</span><span class="p">,:],</span><span class="n">interpolation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]],</span> 
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span><span class="n">aspect</span> <span class="o">=</span> <span class="mf">30.0</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; - iy = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icy</span><span class="p">));</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]])</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">]],[</span><span class="n">cz</span><span class="p">,</span><span class="n">cz</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">cy</span><span class="p">,</span><span class="n">cy</span><span class="p">],[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icz</span><span class="p">),[</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.02</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">]),</span><span class="n">cz</span><span class="p">])</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;ix = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">icx</span><span class="p">),[</span><span class="n">cx</span><span class="p">,</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmin&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmax&#39;</span><span class="p">])],</span> <span class="n">rotation</span><span class="o">=</span> <span class="mf">90.0</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X (m)&#39;</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Z (m)&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specify-the-3d-grid">
<h2>Specify the 3D Grid<a class="headerlink" href="#specify-the-3d-grid" title="Permalink to this heading">#</a></h2>
<p>For computational efficiency we only use a few layers in Z vertical direction for fast model runs and ease of visualization,</p>
<ul class="simple">
<li><p>we will veiw each iz layer as a plan view plot</p></li>
<li><p>I only plot the data on the lowest section, as I have set all the data to be at the cell centroids in the lowest layer</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">zmin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">;</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">;</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">nx</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">nz</span> <span class="o">=</span> <span class="mi">3</span>                                      <span class="c1"># number of cells</span>

<span class="n">grd3D</span> <span class="o">=</span> <span class="n">make_grid_3D</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">nz</span><span class="p">)</span> <span class="c1"># make 3D grid dictionary</span>

<span class="n">icx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cx</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icx</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">]</span> <span class="c1"># center layers and slices for plotting</span>
<span class="n">icy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icy</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">]</span>
<span class="n">icz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">cz</span> <span class="o">=</span> <span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmn&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">icz</span><span class="o">*</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zsiz&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-synthetic-data">
<h2>Make Synthetic Data<a class="headerlink" href="#make-synthetic-data" title="Permalink to this heading">#</a></h2>
<p>We have 2 options,</p>
<ol class="arabic simple">
<li><p>random data</p></li>
<li><p>small provided data</p></li>
</ol>
<p>More on the random data case,</p>
<ul class="simple">
<li><p>since the data is random it is best to not include too much data as this woudl result in inconsistency with the selected variogram model</p></li>
<li><p>i.e., random data is 100% nugget effect</p></li>
</ul>
<p>The data is in layer iz = 0 only,</p>
<ul class="simple">
<li><p>to demonstrate exact conditioning on layer iz = 0 and spatial continuity with the other layers</p></li>
<li><p>to simply the plotting of data and model together, i.e., I show the data with the iz = 0 slice and remove the data for the other slices</p></li>
</ul>
<p>These choices are all made to simplify this demonstration workflow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">73073</span><span class="p">;</span> <span class="n">nbin</span> <span class="o">=</span> <span class="mi">40</span>                                       <span class="c1"># set the random seed again to ensure repeatable data</span>

<span class="n">random_data</span> <span class="o">=</span> <span class="kc">True</span><span class="p">;</span> <span class="n">ndata</span> <span class="o">=</span> <span class="mi">50</span>                                <span class="c1"># random data boolean and if random data, number of random data</span>

<span class="k">if</span> <span class="n">random_data</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>                                       <span class="c1"># method for making random data</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">xmax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ndata</span><span class="p">)</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">xmax</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ndata</span><span class="p">)</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">ndata</span><span class="p">),</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">por_sand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ndata</span><span class="p">)</span> <span class="c1"># shale and sand values from respective distributions</span>
    <span class="n">por_shale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">ndata</span><span class="p">)</span> 
    <span class="n">facies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">ndata</span><span class="p">)</span>                <span class="c1"># shale (0) and sand (1)</span>
    <span class="n">porosity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">facies</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">por_shale</span><span class="p">,</span> <span class="n">por_sand</span><span class="p">)</span>     <span class="c1"># if shale take from shale distribution, otherwise the sand distribution</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.001</span><span class="p">,</span><span class="mf">55.01</span><span class="p">,</span><span class="mf">75.01</span><span class="p">,</span><span class="mf">95.01</span><span class="p">]);</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">55.0</span><span class="p">,</span><span class="mf">75.0</span><span class="p">,</span><span class="mf">15.0</span><span class="p">]);</span> <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
    <span class="n">porosity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.06</span><span class="p">,</span><span class="mf">0.09</span><span class="p">,</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.15</span><span class="p">]);</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="n">dx</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="n">dy</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span><span class="n">dz</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">:</span><span class="n">facies</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">:</span><span class="n">porosity</span><span class="p">})</span>
<span class="n">df_shale</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">];</span> <span class="n">df_sand</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">pormin</span> <span class="o">=</span> <span class="mf">0.00</span><span class="p">;</span> <span class="n">pormax</span> <span class="o">=</span> <span class="mf">0.19</span>                                  <span class="c1"># set feature min and max for colorbars</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">99999.9</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mf">99999.9</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>                                              <span class="c1"># plot the sythetic data</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Facies&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap_facies</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sc</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Porosity (fraction)&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">420</span><span class="p">,</span><span class="mi">420</span><span class="p">],[</span><span class="mi">15</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap_facies</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Sand&#39;</span><span class="p">,[</span><span class="mi">440</span><span class="p">,</span><span class="mi">45</span><span class="p">]);</span> <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Shale&#39;</span><span class="p">,[</span><span class="mi">440</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">);</span> <span class="n">add_grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X (m)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y (m)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Data on Layer iz = 0&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_sand</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">nbin</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df_shale</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">nbin</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">]);</span> <span class="n">add_grid</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porosity (fraction)&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porosity Distribution by-Facies&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/30806af927a1cfb69b41640da00d410ed72a3f7039f1c906cfe4d3643a0e8d20.png" src="_images/30806af927a1cfb69b41640da00d410ed72a3f7039f1c906cfe4d3643a0e8d20.png" />
</div>
</div>
</section>
<section id="sisim-3d-demonstration">
<h2>SISIM 3D Demonstration<a class="headerlink" href="#sisim-3d-demonstration" title="Permalink to this heading">#</a></h2>
<p>Using the grid definition and synthetic data above, here we calculate realizations of sequential indicator simulation. Here’s the current assumptions,</p>
<ul class="simple">
<li><p><strong>Two Facies</strong> - sand (1) and shale (0)</p></li>
<li><p><strong>Same Indicator Variogram</strong> - for both sand and shale. You can experiment with this, but with 2 facies there is limited freedom as they constrain each other and contradictory (very different) variogram models will likely not be honored and lead to a lot of order relations issues.</p></li>
<li><p><strong>Random Data</strong> - from above. Warning, too many random data will impose nugget effect spatial continuity in the realizations. Ironically, the best way to make data synthetic data consistent with a variogram model is to calculate an unconditional realization and to extract the data, i.e., you need a simulation to make data for a simulation! I wanted to keep this demonstration simple so I just made random data.</p></li>
<li><p><strong>Singular Matrices</strong> - data cannot be exactly at cell centroids as this could cause previously simulated nodes and data to be collocated and this will cause singular kriging matrices. A very small random offset will take care of this.</p></li>
<li><p><strong>First Version</strong> - I have not tested all the options, for example, locally variable mean (LVM), collocated cokriging options have not been checked.</p></li>
</ul>
<p>Now here is the code to calculate an ensemble of simulated facies realizations.</p>
<ul class="simple">
<li><p>we run nreal realizations and visualize the layer iz = 0 layer of each to check the data conditioning</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display  

<span class="n">seed</span> <span class="o">=</span> <span class="mi">73071</span>                                                  <span class="c1"># realization seed</span>
<span class="n">nreal</span> <span class="o">=</span> <span class="mi">3</span>                                                     <span class="c1"># number of realizations</span>

<span class="n">ncut</span> <span class="o">=</span> <span class="mi">2</span>                                                      <span class="c1"># number of facies</span>
<span class="n">thresh</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>                                                <span class="c1"># the facies categories (use consistent order for all lists)</span>
<span class="n">gcdf</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>                                              <span class="c1"># the global proportions of the categories (shale, sand)</span>
<span class="n">variomaj</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">;</span> <span class="n">variomin</span> <span class="o">=</span> <span class="mf">50.0</span><span class="p">;</span> <span class="n">variovert</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">facies_varios</span> <span class="o">=</span> <span class="p">[]</span>                                            <span class="c1"># the variogram list with shale and sand variograms (in order of thresh list)</span>
<span class="n">facies_varios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geostats</span><span class="o">.</span><span class="n">make_variogram3D</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">azi1</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span><span class="n">dip1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">variomaj</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">variomin</span><span class="p">,</span><span class="n">hvert1</span><span class="o">=</span><span class="n">variovert</span><span class="p">))</span> 
<span class="n">facies_varios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geostats</span><span class="o">.</span><span class="n">make_variogram3D</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">azi1</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span><span class="n">dip1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">variomaj</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">variomin</span><span class="p">,</span><span class="n">hvert1</span><span class="o">=</span><span class="n">variovert</span><span class="p">))</span> 
    
<span class="n">ndmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ndmax</span> <span class="o">=</span> <span class="mi">3</span>                                          <span class="c1"># minimum and maximum data for indicator kriging</span>
<span class="n">nodmax</span> <span class="o">=</span> <span class="mi">3</span>                                                    <span class="c1"># maximum previously simulated nodes for indicator kriging</span>
<span class="n">nxdis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nydis</span> <span class="o">=</span> <span class="mi">1</span>                                          <span class="c1"># block kriging discretizations</span>
<span class="n">dummy_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>                           <span class="c1"># current version requires trend - if wrong size = ignored </span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mi">999</span>                                       <span class="c1"># data trimming limits</span>

<span class="n">run_model</span> <span class="o">=</span> <span class="kc">True</span>                                              <span class="c1"># run the simulation model</span>
<span class="n">nreal</span> <span class="o">=</span> <span class="mi">3</span>                                                     <span class="c1"># number of realizations</span>

<span class="k">if</span> <span class="n">run_model</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">sim_ik</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sisim_3D</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">ivtype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">koption</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ncut</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">thresh</span><span class="o">=</span><span class="n">thresh</span><span class="p">,</span><span class="n">gcdf</span><span class="o">=</span><span class="n">gcdf</span><span class="p">,</span><span class="n">trend</span><span class="o">=</span><span class="n">dummy_trend</span><span class="p">,</span>
        <span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">zmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">middle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">mpar</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">nreal</span><span class="o">=</span><span class="n">nreal</span><span class="p">,</span>
        <span class="n">nx</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span><span class="n">xmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">],</span><span class="n">xsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">ymn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">],</span><span class="n">ysiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">],</span>
        <span class="n">nz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">],</span><span class="n">zmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmn&#39;</span><span class="p">],</span><span class="n">zsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zsiz&#39;</span><span class="p">],</span>
        <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">,</span><span class="n">ndmin</span><span class="o">=</span><span class="n">ndmin</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="n">ndmax</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="n">nodmax</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">varios</span><span class="o">=</span><span class="n">facies_varios</span><span class="p">)</span>

<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">nreal</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>                          <span class="c1"># adjust plot for the number of realizations</span>
<span class="k">for</span> <span class="n">ireal</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nreal</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  
    <span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">sim_ik</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Sequential Indicator Simulation Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - iz = 0&#39;</span><span class="p">,</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">cmap_facies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nrow</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/96cac9d24ed448a04dc8ff8e34bb2862dcd9558524b898021496256e7f39f77c.png" src="_images/96cac9d24ed448a04dc8ff8e34bb2862dcd9558524b898021496256e7f39f77c.png" />
</div>
</div>
<p>Let’s plot all the iz layers of the first realization.</p>
<ul class="simple">
<li><p>I select a long vertical variogram range relative to the model vertical extents (zmax - zmin) so we can see conspicuous spatial continuity between the layers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ireal</span> <span class="o">=</span> <span class="mi">0</span>                                                     <span class="c1"># select realization for display</span>

<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>                    <span class="c1"># adjust plot for the number of realizations</span>
<span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   
    <span class="k">if</span> <span class="n">iz</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">sim_ik</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="n">iz</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Sequential Indicator Simulation - Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">cmap_facies</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">GSLIB</span><span class="o">.</span><span class="n">pixelplt_st</span><span class="p">(</span><span class="n">sim_ik</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="n">iz</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span>
                         <span class="s1">&#39;Sequential Indicator Simulation - Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">cmap_facies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nrow</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b96fb428c6f51c4af6f28b8de268a5e1494288532104bde0f515ae9cbb3747bc.png" src="_images/b96fb428c6f51c4af6f28b8de268a5e1494288532104bde0f515ae9cbb3747bc.png" />
</div>
</div>
<p>Now let’s look at the center slices for a single realization of our 3D facies model,</p>
<ul class="simple">
<li><p>y and x - plan view</p></li>
<li><p>z and x - vertical slice in x</p></li>
<li><p>z and y - vertical slice in y</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ireal</span> <span class="o">=</span> <span class="mi">0</span>                                                     <span class="c1"># select realization for display</span>

<span class="n">plot_center_slices_3D</span><span class="p">(</span><span class="n">sim_ik</span><span class="p">[</span><span class="n">ireal</span><span class="p">],</span><span class="n">grd3D</span><span class="p">,</span><span class="s1">&#39;Facies 3D Simulation - Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span> <span class="c1"># plotting function</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">nvbin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap_facies</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/56daceef3e5912d4fc7b453d0d6da03a6fe95274425a1b59bd0c7af48546b585.png" src="_images/56daceef3e5912d4fc7b453d0d6da03a6fe95274425a1b59bd0c7af48546b585.png" />
</div>
</div>
</section>
<section id="sgsim-3d-demonstration">
<h2>SGSIM 3D Demonstration<a class="headerlink" href="#sgsim-3d-demonstration" title="Permalink to this heading">#</a></h2>
<p>Now we can simulate porosity sand only and shale only realizations and then use the ‘cookie cutter’ method to put them together.</p>
<ul class="simple">
<li><p><strong>Same Variogram</strong> - for both sand and shale. You can experiment with this. You have complete freedom to assign any variograms to both.</p></li>
<li><p><strong>Random Data</strong> - from above. Warning, too many random data will impose nugget effect spatial continuity in the realizations. Ironically, the best way to make data synthetic data consistent with a variogram model is to calculate an unconditional realization and to extract the data, i.e., you need a simulation to make data for a simulation! I wanted to keep this demonstration simple so I just made random data.</p></li>
<li><p><strong>Singular Matrices</strong> - data cannot be exactly at cell centroids as this could cause previously simulated nodes and data to be collocated and this will cause singular kriging matrices. A very small random offset will take care of this.</p></li>
<li><p><strong>First Version</strong> - I have not tested all the options, for example, locally variable mean (LVM), collocated cokriging options have not been checked.</p></li>
</ul>
<p>Now here is the code to calculate an ensemble of simulated porosity realizations.</p>
<ul class="simple">
<li><p><strong>by-facies</strong> - we simulate porosity for shale and sand separately and then used the “cookie-cutter” approach to combine with the associated facies realization, by selecting shale porosity at shale locations and sand porosity at sand locations</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span> --no-display  

<span class="n">seed</span> <span class="o">=</span> <span class="mi">73077</span>                                                  <span class="c1"># realization seed</span>
<span class="n">nreal</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">variomaj</span> <span class="o">=</span> <span class="mf">70.0</span><span class="p">;</span> <span class="n">variomin</span> <span class="o">=</span> <span class="mf">30.0</span><span class="p">;</span> <span class="n">variovert</span> <span class="o">=</span> <span class="mf">1.0</span>             <span class="c1"># porosity variogram, assumed same for shale and sand facies</span>
<span class="n">porosity_vario</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">make_variogram3D</span><span class="p">(</span><span class="n">nug</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">nst</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">it1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cc1</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">azi1</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span><span class="n">dip1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">hmaj1</span><span class="o">=</span><span class="n">variomaj</span><span class="p">,</span><span class="n">hmin1</span><span class="o">=</span><span class="n">variomin</span><span class="p">,</span><span class="n">hvert1</span><span class="o">=</span><span class="n">variovert</span><span class="p">)</span> 
    
<span class="n">ndmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ndmax</span> <span class="o">=</span> <span class="mi">4</span>                                          <span class="c1"># minimum and maximum data for indicator kriging</span>
<span class="n">nodmax</span> <span class="o">=</span> <span class="mi">10</span>                                                   <span class="c1"># maximum previously simulated nodes for indicator kriging</span>
<span class="n">nxdis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nydis</span> <span class="o">=</span> <span class="mi">1</span>                                          <span class="c1"># block kriging discretizations</span>
<span class="n">dummy_trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>                          <span class="c1"># current version requires trend - if wrong size = ignored </span>
<span class="n">tmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">999</span><span class="p">;</span> <span class="n">tmax</span> <span class="o">=</span> <span class="mi">999</span>                                       <span class="c1"># data trimming limits</span>

<span class="n">run_model</span> <span class="o">=</span> <span class="kc">True</span>                                              <span class="c1"># run the simulation model</span>

<span class="k">if</span> <span class="n">run_model</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">sim_por_sand</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sgsim_3D</span><span class="p">(</span><span class="n">df_sand</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">wcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">scol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">itrans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ismooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dftrans</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">tcol</span><span class="o">=</span><span class="s1">&#39;Ref&#39;</span><span class="p">,</span><span class="n">twtcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">zmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">nreal</span><span class="o">=</span><span class="n">nreal</span><span class="p">,</span>
        <span class="n">nx</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span><span class="n">xmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">],</span><span class="n">xsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">ymn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">],</span><span class="n">ysiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">],</span>
        <span class="n">nz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">],</span><span class="n">zmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmn&#39;</span><span class="p">],</span><span class="n">zsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zsiz&#39;</span><span class="p">],</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">ndmin</span><span class="o">=</span><span class="n">ndmin</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="n">ndmax</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="n">nodmax</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">colocorr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sec_map</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">porosity_vario</span><span class="p">)</span>
    <span class="n">sim_por_sand</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">sim_ik</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="n">sim_por_shale</span> <span class="o">=</span> <span class="n">geostats</span><span class="o">.</span><span class="n">sgsim_3D</span><span class="p">(</span><span class="n">df_shale</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">wcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">scol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span><span class="n">itrans</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ismooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dftrans</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">tcol</span><span class="o">=</span><span class="s1">&#39;Ref&#39;</span><span class="p">,</span><span class="n">twtcol</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">zmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">zmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">ltail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ltpar</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">utail</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">utpar</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">nreal</span><span class="o">=</span><span class="n">nreal</span><span class="p">,</span>
        <span class="n">nx</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nx&#39;</span><span class="p">],</span><span class="n">xmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmn&#39;</span><span class="p">],</span><span class="n">xsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">ny</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ny&#39;</span><span class="p">],</span><span class="n">ymn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymn&#39;</span><span class="p">],</span><span class="n">ysiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ysiz&#39;</span><span class="p">],</span>
        <span class="n">nz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">],</span><span class="n">zmn</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zmn&#39;</span><span class="p">],</span><span class="n">zsiz</span><span class="o">=</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;zsiz&#39;</span><span class="p">],</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">ndmin</span><span class="o">=</span><span class="n">ndmin</span><span class="p">,</span><span class="n">ndmax</span><span class="o">=</span><span class="n">ndmax</span><span class="p">,</span><span class="n">nodmax</span><span class="o">=</span><span class="n">nodmax</span><span class="p">,</span><span class="n">mults</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nmult</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">noct</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">ktype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">colocorr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sec_map</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vario</span><span class="o">=</span><span class="n">porosity_vario</span><span class="p">)</span>
    <span class="n">sim_por_shale</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">sim_ik</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">sim_por</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">sim_por_shale</span><span class="p">),</span> <span class="n">sim_por_shale</span><span class="p">,</span> <span class="n">sim_por_sand</span><span class="p">)</span>

<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">nreal</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>                          <span class="c1"># adjust plot for the number of realizations</span>
<span class="k">for</span> <span class="n">ireal</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nreal</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                  
    <span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">sim_por</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span>
        <span class="n">df_sand</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Sequential Gaussian Simulation - Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Porosity&#39;</span><span class="p">],</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">inferno</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nrow</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a797c84a3efc9b0cd026b12ad401263ec76d667a7d7fabe8d3e50a7e6f529953.png" src="_images/a797c84a3efc9b0cd026b12ad401263ec76d667a7d7fabe8d3e50a7e6f529953.png" />
</div>
</div>
<p>Let’s plot all the iz layers of the first realization.</p>
<ul class="simple">
<li><p>I select a long vertical variogram range relative to the model vertical extents (zmax - zmin) so we can see conspicuous spatial continuity between the layers.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ireal</span> <span class="o">=</span> <span class="mi">0</span>                                                     <span class="c1"># select realization for display</span>

<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(((</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]</span><span class="o">+</span><span class="mf">0.9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span>                    <span class="c1"># adjust plot for the number of realizations</span>
<span class="k">for</span> <span class="n">iz</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;nz&#39;</span><span class="p">]):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   
    <span class="k">if</span> <span class="n">iz</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">GSLIB</span><span class="o">.</span><span class="n">locpix_st</span><span class="p">(</span><span class="n">sim_por</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="n">iz</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Porosity 3D Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Facies&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">GSLIB</span><span class="o">.</span><span class="n">pixelplt_st</span><span class="p">(</span><span class="n">sim_por</span><span class="p">[</span><span class="n">ireal</span><span class="p">][</span><span class="n">iz</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xmax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymin&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;ymax&#39;</span><span class="p">],</span><span class="n">grd3D</span><span class="p">[</span><span class="s1">&#39;xsiz&#39;</span><span class="p">],</span><span class="n">pormin</span><span class="p">,</span><span class="n">pormax</span><span class="p">,</span>
                         <span class="s1">&#39;Porosity 3D Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - iz = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">iz</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;X(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Y(m)&#39;</span><span class="p">,</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span><span class="n">cmap</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">nrow</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/21692d6cf37deeabbb3d31dccdc160a79651c38ced694ca6a55090aed6dabc0f.png" src="_images/21692d6cf37deeabbb3d31dccdc160a79651c38ced694ca6a55090aed6dabc0f.png" />
</div>
</div>
<p>Now let’s look at the center slices for a single porosity realization,</p>
<ul class="simple">
<li><p>y and x - plan view</p></li>
<li><p>z and x - vertical slice in x</p></li>
<li><p>z and y - vertical slice in y</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ireal</span> <span class="o">=</span> <span class="mi">0</span>                                                     <span class="c1"># select realization for display</span>

<span class="n">plot_center_slices_3D</span><span class="p">(</span><span class="n">sim_por</span><span class="p">[</span><span class="n">ireal</span><span class="p">],</span><span class="n">grd3D</span><span class="p">,</span><span class="s1">&#39;Porosity 3D Simulation, Realization #&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ireal</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Porosity&#39;</span><span class="p">,</span> <span class="c1"># plotting function</span>
        <span class="n">vmin</span><span class="o">=</span><span class="n">pormin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">pormax</span><span class="p">,</span><span class="n">nvbin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9591ab314738bfaba95388889a9f1479c067ec41e841bfb7ecec591d1c18b9b8.png" src="_images/9591ab314738bfaba95388889a9f1479c067ec41e841bfb7ecec591d1c18b9b8.png" />
</div>
</div>
</section>
<section id="comments">
<h2>Comments<a class="headerlink" href="#comments" title="Permalink to this heading">#</a></h2>
<p>I hope you found this demonstration of 3D simulation chapter helpful. Much more could be done and discussed, I have many more resources. Check out my <a class="reference external" href="https://michaelpyrcz.com/my-resources">shared resource inventory</a>,</p>
<p><em>Michael</em></p>
</section>
<section id="about-the-author">
<h2>About the Author<a class="headerlink" href="#about-the-author" title="Permalink to this heading">#</a></h2>
<figure style="text-align: center;">
  <img src="_static/intro/michael_pyrcz_officeshot_jacket.jpg" style="display: block; margin: 0 auto; width: 70%;">
  <figcaption style="text-align: center;"> Professor Michael Pyrcz in his office on the 40 acres, campus of The University of Texas at Austin.
</figcaption>
</figure>
<p>Michael Pyrcz is a professor in the <a class="reference external" href="https://cockrell.utexas.edu/faculty-directory/alphabetical/p">Cockrell School of Engineering</a>, and the <a class="reference external" href="https://www.jsg.utexas.edu/researcher/michael_pyrcz/">Jackson School of Geosciences</a>, at <a class="reference external" href="https://www.utexas.edu/">The University of Texas at Austin</a>, where he researches and teaches subsurface, spatial data analytics, geostatistics, and machine learning. Michael is also,</p>
<ul class="simple">
<li><p>the principal investigator of the <a class="reference external" href="https://fri.cns.utexas.edu/energy-analytics">Energy Analytics</a> freshmen research initiative and a core faculty in the Machine Learn Laboratory in the College of Natural Sciences, The University of Texas at Austin</p></li>
<li><p>an associate editor for <a class="reference external" href="https://www.sciencedirect.com/journal/computers-and-geosciences/about/editorial-board">Computers and Geosciences</a>, and a board member for <a class="reference external" href="https://link.springer.com/journal/11004/editorial-board">Mathematical Geosciences</a>, the International Association for Mathematical Geosciences.</p></li>
</ul>
<p>Michael has written over 70 <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en">peer-reviewed publications</a>, a <a class="reference external" href="https://pypi.org/project/geostatspy/">Python package</a> for spatial data analytics, co-authored a textbook on spatial data analytics, <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistical Reservoir Modeling</a> and author of two recently released e-books, <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostatistics in Python: a Hands-on Guide with GeostatsPy</a> and <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/intro.html">Applied Machine Learning in Python: a Hands-on Guide with Code</a>.</p>
<p>All of Michael’s university lectures are available on his <a class="reference external" href="https://www.youtube.com/&#64;GeostatsGuyLectures">YouTube Channel</a> with links to 100s of Python interactive dashboards and well-documented workflows in over 40 repositories on his <a class="reference external" href="https://github.com/GeostatsGuy">GitHub account</a>, to support any interested students and working professionals with evergreen content. To find out more about Michael’s work and shared educational resources visit his <span class="xref myst">Website</span>.</p>
</section>
<section id="want-to-work-together">
<h2>Want to Work Together?<a class="headerlink" href="#want-to-work-together" title="Permalink to this heading">#</a></h2>
<p>I hope this content is helpful to those that want to learn more about subsurface modeling, data analytics and machine learning. Students and working professionals are welcome to participate.</p>
<ul class="simple">
<li><p>Want to invite me to visit your company for training, mentoring, project review, workflow design and / or consulting? I’d be happy to drop by and work with you!</p></li>
<li><p>Interested in partnering, supporting my graduate student research or my Subsurface Data Analytics and Machine Learning consortium (co-PI is Professor John Foster)? My research combines data analytics, stochastic modeling and machine learning theory with practice to develop novel methods and workflows to add value. We are solving challenging subsurface problems!</p></li>
<li><p>I can be reached at <a class="reference external" href="mailto:mpyrcz&#37;&#52;&#48;austin&#46;utexas&#46;edu">mpyrcz<span>&#64;</span>austin<span>&#46;</span>utexas<span>&#46;</span>edu</a>.</p></li>
</ul>
<p>I’m always happy to discuss,</p>
<p><em>Michael</em></p>
<p>Michael Pyrcz, Ph.D., P.Eng. Professor, Cockrell School of Engineering and The Jackson School of Geosciences, The University of Texas at Austin</p>
<p>More Resources Available at: <a class="reference external" href="https://twitter.com/geostatsguy">Twitter</a> | <a class="reference external" href="https://github.com/GeostatsGuy">GitHub</a> | <a class="reference external" href="http://michaelpyrcz.com">Website</a> | <a class="reference external" href="https://scholar.google.com/citations?user=QVZ20eQAAAAJ&amp;hl=en&amp;oi=ao">GoogleScholar</a> | <a class="reference external" href="https://www.amazon.com/Geostatistical-Reservoir-Modeling-Michael-Pyrcz/dp/0199731446">Geostatistics Book</a> | <a class="reference external" href="https://www.youtube.com/channel/UCLqEr-xV-ceHdXXXrTId5ig">YouTube</a>  | <a class="reference external" href="https://geostatsguy.github.io/GeostatsPyDemos_Book/intro.html">Applied Geostats in Python e-book</a> | <a class="reference external" href="https://geostatsguy.github.io/MachineLearningDemos_Book/">Applied Machine Learning in Python e-book</a> | <a class="reference external" href="https://www.linkedin.com/in/michael-pyrcz-61a648a1">LinkedIn</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="GeostatsPy_categorical_indicator_simulation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Indicator Simulation</p>
      </div>
    </a>
    <a class="right-next"
       href="GeostatsPy_cosimulation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cosimulation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geostatistics-in-3d">Geostatistics in 3D</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-custom-colorbar">Make Custom Colorbar</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#declare-functions">Declare Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#specify-the-3d-grid">Specify the 3D Grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#make-synthetic-data">Make Synthetic Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sisim-3d-demonstration">SISIM 3D Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sgsim-3d-demonstration">SGSIM 3D Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comments">Comments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-the-author">About the Author</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#want-to-work-together">Want to Work Together?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michael J. Pyrcz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>